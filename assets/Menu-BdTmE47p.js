import{b as xe,k as me,a as Ke,c as ee,d as Pe,e as te,f as Ce,$ as De,g as ie,l as Me,h as Se,i as we}from"./Collection-C4H3d3-i.js";import{c as le,b as oe,$ as ne,k as Fe,e as H,i as U,g as ke,f as _e,d as Ne}from"./useFocusRing-8RL9AhDF.js";import{r as d,R as y}from"./index-DH5ua8nC.js";import{a as Re}from"./Text-CImjXWr2.js";import{$ as L,e as V,c as Ee}from"./useFocusWithin-D15f1-3B.js";import{$ as _,i as Ie,b as Be}from"./focusSafely-CjmyL4wt.js";import{$ as J}from"./isScrollable-BSEN4xi5.js";import{$ as Ae}from"./useCollator-DjJfuWgZ.js";import{c as Ve,$ as ze,b as He}from"./usePress-BnN3djkX.js";import{$ as Ue}from"./useKeyboard-BZGC9FVW.js";import{$ as Le}from"./useControlledState-BSXamw7l.js";import{$ as Te}from"./FocusScope-92UDUlTt.js";class Q{getItemRect(e){let t=this.ref.current;if(!t)return null;let i=e!=null?t.querySelector(`[data-key="${CSS.escape(e.toString())}"]`):null;if(!i)return null;let l=t.getBoundingClientRect(),n=i.getBoundingClientRect();return{x:n.left-l.left+t.scrollLeft,y:n.top-l.top+t.scrollTop,width:n.width,height:n.height}}getContentSize(){let e=this.ref.current;var t,i;return{width:(t=e==null?void 0:e.scrollWidth)!==null&&t!==void 0?t:0,height:(i=e==null?void 0:e.scrollHeight)!==null&&i!==void 0?i:0}}getVisibleRect(){let e=this.ref.current;var t,i,l,n;return{x:(t=e==null?void 0:e.scrollLeft)!==null&&t!==void 0?t:0,y:(i=e==null?void 0:e.scrollTop)!==null&&i!==void 0?i:0,width:(l=e==null?void 0:e.offsetWidth)!==null&&l!==void 0?l:0,height:(n=e==null?void 0:e.offsetHeight)!==null&&n!==void 0?n:0}}constructor(e){this.ref=e}}class Oe{isDisabled(e){var t;return this.disabledBehavior==="all"&&(((t=e.props)===null||t===void 0?void 0:t.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,t){let i=e;for(;i!=null;){let l=this.collection.getItem(i);if((l==null?void 0:l.type)==="item"&&!this.isDisabled(l))return i;i=t(i)}return null}getNextKey(e){let t=e;return t=this.collection.getKeyAfter(t),this.findNextNonDisabled(t,i=>this.collection.getKeyAfter(i))}getPreviousKey(e){let t=e;return t=this.collection.getKeyBefore(t),this.findNextNonDisabled(t,i=>this.collection.getKeyBefore(i))}findKey(e,t,i){let l=e,n=this.layoutDelegate.getItemRect(l);if(!n||l==null)return null;let r=n;do{if(l=t(l),l==null)break;n=this.layoutDelegate.getItemRect(l)}while(n&&i(r,n)&&l!=null);return l}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getNextKey(t),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getPreviousKey(t),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let t=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,i=>this.layoutDelegate[t](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,i=>this.getNextColumn(i,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let t=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,i=>this.layoutDelegate[t](i))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,i=>this.getNextColumn(i,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyAfter(t))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyBefore(t))}getKeyPageAbove(e){let t=this.ref.current,i=this.layoutDelegate.getItemRect(e);if(!i)return null;if(t&&!J(t))return this.getFirstKey();let l=e;if(this.orientation==="horizontal"){let n=Math.max(0,i.x+i.width-this.layoutDelegate.getVisibleRect().width);for(;i&&i.x>n&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let n=Math.max(0,i.y+i.height-this.layoutDelegate.getVisibleRect().height);for(;i&&i.y>n&&l!=null;)l=this.getKeyAbove(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,i=this.layoutDelegate.getItemRect(e);if(!i)return null;if(t&&!J(t))return this.getLastKey();let l=e;if(this.orientation==="horizontal"){let n=Math.min(this.layoutDelegate.getContentSize().width,i.y-i.width+this.layoutDelegate.getVisibleRect().width);for(;i&&i.x<n&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}else{let n=Math.min(this.layoutDelegate.getContentSize().height,i.y-i.height+this.layoutDelegate.getVisibleRect().height);for(;i&&i.y<n&&l!=null;)l=this.getKeyBelow(l),i=l==null?null:this.layoutDelegate.getItemRect(l)}return l??this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let i=this.collection,l=t||this.getFirstKey();for(;l!=null;){let n=i.getItem(l);if(!n)return null;let r=n.textValue.slice(0,e.length);if(n.textValue&&this.collator.compare(r,e)===0)return l;l=this.getNextKey(l)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||"all",this.orientation=t.orientation||"vertical",this.direction=t.direction,this.layout=t.layout||"stack",this.layoutDelegate=t.layoutDelegate||new Q(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new Q(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function We(o){let{selectionManager:e,collection:t,disabledKeys:i,ref:l,keyboardDelegate:n,layoutDelegate:r}=o,s=Ae({usage:"search",sensitivity:"base"}),a=e.disabledBehavior,h=d.useMemo(()=>n||new Oe({collection:t,disabledKeys:i,disabledBehavior:a,ref:l,collator:s,layoutDelegate:r}),[n,r,t,i,l,s,a]),{collectionProps:u}=xe({...o,ref:l,selectionManager:e,keyboardDelegate:h});return{listProps:u}}const Z=new WeakMap;function qe(o){let e=Z.get(o);if(e!=null)return e;let t=0,i=l=>{for(let n of l)n.type==="section"?i(me(n,o)):t++};return i(o),Z.set(o,t),t}const ae=new WeakMap;function Xe(o,e,t){let{shouldFocusWrap:i=!0,onKeyDown:l,onKeyUp:n,...r}=o;!o["aria-label"]&&!o["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=_(o,{labelable:!0}),{listProps:a}=We({...r,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:i,linkBehavior:"override"});return ae.set(e,{onClose:o.onClose,onAction:o.onAction,shouldUseVirtualFocus:o.shouldUseVirtualFocus}),{menuProps:L(s,{onKeyDown:l,onKeyUp:n},{role:"menu",...a,onKeyDown:h=>{var u;(h.key!=="Escape"||o.shouldUseVirtualFocus)&&((u=a.onKeyDown)===null||u===void 0||u.call(a,h))}})}}function Ye(o,e,t){let{id:i,key:l,closeOnSelect:n,isVirtualized:r,"aria-haspopup":s,onPressStart:a,onPressUp:h,onPress:u,onPressChange:p,onPressEnd:v,onHoverStart:b,onHoverChange:x,onHoverEnd:C,onKeyDown:m,onKeyUp:M,onFocus:S,onFocusChange:N,onBlur:se,selectionManager:g=e.selectionManager}=o,$=!!s,O=$&&o["aria-expanded"]==="true";var R;let K=(R=o.isDisabled)!==null&&R!==void 0?R:g.isDisabled(l);var E;let W=(E=o.isSelected)!==null&&E!==void 0?E:g.isSelected(l),w=ae.get(e),f=e.collection.getItem(l),P=o.onClose||w.onClose,re=Ve(),I=c=>{var A;if(!$){if(!(f==null||(A=f.props)===null||A===void 0)&&A.onAction?f.props.onAction():o.onAction&&o.onAction(l),w.onAction){let ve=w.onAction;ve(l)}c.target instanceof HTMLAnchorElement&&f&&re.open(c.target,c,f.props.href,f.props.routerOptions)}},B="menuitem";$||(g.selectionMode==="single"?B="menuitemradio":g.selectionMode==="multiple"&&(B="menuitemcheckbox"));let q=V(),X=V(),Y=V(),F={id:i,"aria-disabled":K||void 0,role:B,"aria-label":o["aria-label"],"aria-labelledby":q,"aria-describedby":[X,Y].filter(Boolean).join(" ")||void 0,"aria-controls":o["aria-controls"],"aria-haspopup":s,"aria-expanded":o["aria-expanded"]};g.selectionMode!=="none"&&!$&&(F["aria-checked"]=W),r&&(F["aria-posinset"]=f==null?void 0:f.index,F["aria-setsize"]=qe(e.collection));let de=c=>{c.pointerType==="keyboard"&&I(c),a==null||a(c)},j=()=>{!$&&P&&(n??(g.selectionMode!=="multiple"||g.isLink(l)))&&P()},ce=c=>{c.pointerType==="mouse"&&(I(c),j()),h==null||h(c)},ue=c=>{c.pointerType!=="keyboard"&&c.pointerType!=="mouse"&&(I(c),j()),u==null||u(c)},{itemProps:D,isFocused:fe}=Ke({id:i,selectionManager:g,key:l,ref:t,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none",shouldUseVirtualFocus:w.shouldUseVirtualFocus}),{pressProps:he,isPressed:be}=ze({onPressStart:de,onPress:ue,onPressUp:ce,onPressChange:p,onPressEnd:v,isDisabled:K}),{hoverProps:ye}=le({isDisabled:K,onHoverStart(c){!Ie()&&!(O&&s==="dialog")&&(g.setFocused(!0),g.setFocusedKey(l)),b==null||b(c)},onHoverChange:x,onHoverEnd:C}),{keyboardProps:ge}=Ue({onKeyDown:c=>{if(c.repeat){c.continuePropagation();return}switch(c.key){case" ":!K&&g.selectionMode==="none"&&!$&&n!==!1&&P&&P();break;case"Enter":!K&&n!==!1&&!$&&P&&P();break;default:$||c.continuePropagation(),m==null||m(c);break}},onKeyUp:M}),{focusProps:$e}=Be({onBlur:se,onFocus:S,onFocusChange:N}),G=_(f==null?void 0:f.props);delete G.id;let pe=He(f==null?void 0:f.props);return{menuItemProps:{...F,...L(G,pe,$?{onFocus:D.onFocus,"data-key":D["data-key"]}:D,he,ye,ge,$e),tabIndex:D.tabIndex!=null&&O?-1:D.tabIndex},labelProps:{id:q},descriptionProps:{id:X},keyboardShortcutProps:{id:Y},isFocused:fe,isSelected:W,isPressed:be,isDisabled:K}}function je(o){let{heading:e,"aria-label":t}=o,i=Ee();return{itemProps:{role:"presentation"},headingProps:e?{id:i,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?i:void 0}}}class Ge{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);var i;return t&&(i=t.prevKey)!==null&&i!==void 0?i:null}getKeyAfter(e){let t=this.keyMap.get(e);var i;return t&&(i=t.nextKey)!==null&&i!==void 0?i:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e,t=t||new Set;let i=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&(s.type==="section"||t.has(s.key)))for(let a of s.childNodes)i(a)};for(let s of e)i(s);let l=null,n=0;for(let[s,a]of this.keyMap)l?(l.nextKey=s,a.prevKey=l.key):(this.firstKey=s,a.prevKey=void 0),a.type==="item"&&(a.index=n++),l=a,l.nextKey=void 0;var r;this.lastKey=(r=l==null?void 0:l.key)!==null&&r!==void 0?r:null}}function Je(o){let{onExpandedChange:e}=o,[t,i]=Le(o.expandedKeys?new Set(o.expandedKeys):void 0,o.defaultExpandedKeys?new Set(o.defaultExpandedKeys):new Set,e),l=ee(o),n=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),r=Pe(o,d.useCallback(a=>new Ge(a,{expandedKeys:t}),[t]),null);return d.useEffect(()=>{l.focusedKey!=null&&!r.getItem(l.focusedKey)&&l.setFocusedKey(null)},[r,l.focusedKey]),{collection:r,expandedKeys:t,disabledKeys:n,toggleKey:a=>{i(Qe(t,a))},setExpandedKeys:i,selectionManager:new te(r,l)}}function Qe(o,e){let t=new Set(o);return t.has(e)?t.delete(e):t.add(e),t}const Ze=d.createContext(null),et=d.createContext({}),tt=d.createContext({}),it=d.createContext({}),lt=d.createContext(null),T=d.createContext(null),ot=d.createContext(null),k=d.createContext(null),nt=d.createContext(null),mt=d.forwardRef(function(e,t){return[e,t]=oe(e,t,lt),y.createElement(Ce,{content:y.createElement(De,e)},i=>i.size>0&&y.createElement(at,{props:e,collection:i,menuRef:t}))});function at({props:o,collection:e,menuRef:t}){let{filterFn:i,collectionProps:l,collectionRef:n}=d.useContext(Ze)||{};t=ne(d.useMemo(()=>Fe(t,n!==void 0?n:null),[n,t]));let r=d.useMemo(()=>i?e.filter(i):e,[e,i]),s=Je({...o,collection:r,children:void 0}),a=d.useContext(ot),{isVirtualized:h,CollectionRoot:u}=d.useContext(ie),{menuProps:p}=Xe({...o,...l,isVirtualized:h,onClose:o.onClose||(a==null?void 0:a.close)},s,t),v=H({defaultClassName:"react-aria-Menu",className:o.className,style:o.style,values:{}});return y.createElement(Te,null,y.createElement("div",{..._(o),...p,...v,ref:t,slot:o.slot||void 0,onScroll:o.onScroll},y.createElement(U,{values:[[T,s],[tt,{elementType:"div"}],[Me,{name:"MenuSection",render:rt}],[nt,{parentMenuRef:t}],[z,null],[k,s.selectionManager]]},y.createElement(u,{collection:s.collection,persistedKeys:Se(s.selectionManager.focusedKey),scrollRef:t}))))}class st extends te{get focusedKey(){return this.parent.focusedKey}get isFocused(){return this.parent.isFocused}setFocusedKey(e,t){return this.parent.setFocusedKey(e,t)}setFocused(e){this.parent.setFocused(e)}get childFocusStrategy(){return this.parent.childFocusStrategy}constructor(e,t){super(e.collection,t),this.parent=e}}function rt(o,e,t,i="react-aria-MenuSection"){var l,n;let r=d.useContext(T),{CollectionBranch:s}=d.useContext(ie),[a,h]=ke();var u;let{headingProps:p,groupProps:v}=je({heading:h,"aria-label":(u=t.props["aria-label"])!==null&&u!==void 0?u:void 0}),b=H({defaultClassName:i,className:(l=t.props)===null||l===void 0?void 0:l.className,style:(n=t.props)===null||n===void 0?void 0:n.style,values:{}}),x=d.useContext(k),C=ee(o),m=o.selectionMode!=null?new st(x,C):x;return y.createElement("section",{..._(o),...v,...b,ref:e},y.createElement(U,{values:[[et,{...p,ref:a}],[k,m]]},y.createElement(s,{collection:r.collection,parent:t})))}const z=d.createContext(null),Kt=we("item",function(e,t,i){var l;[e,t]=oe(e,t,z);let n=(l=_e(z))===null||l===void 0?void 0:l.id,r=d.useContext(T),s=ne(t),a=d.useContext(k),{menuItemProps:h,labelProps:u,descriptionProps:p,keyboardShortcutProps:v,...b}=Ye({...e,id:n,key:i.key,selectionManager:a},r,s),{isFocusVisible:x,focusProps:C}=Ne(),{hoverProps:m,isHovered:M}=le({isDisabled:b.isDisabled}),S=H({...e,id:void 0,children:i.rendered,defaultClassName:"react-aria-MenuItem",values:{...b,isHovered:M,isFocusVisible:x,selectionMode:a.selectionMode,selectionBehavior:a.selectionBehavior,hasSubmenu:!!e["aria-haspopup"],isOpen:e["aria-expanded"]==="true"}}),N=e.href?"a":"div";return y.createElement(N,{...L(h,C,m),...S,ref:s,"data-disabled":b.isDisabled||void 0,"data-hovered":M||void 0,"data-focused":b.isFocused||void 0,"data-focus-visible":x||void 0,"data-pressed":b.isPressed||void 0,"data-selected":b.isSelected||void 0,"data-selection-mode":a.selectionMode==="none"?void 0:a.selectionMode,"data-has-submenu":!!e["aria-haspopup"]||void 0,"data-open":e["aria-expanded"]==="true"||void 0},y.createElement(U,{values:[[Re,{slots:{label:u,description:p}}],[it,v]]},S.children))});export{mt as $,Kt as a};
