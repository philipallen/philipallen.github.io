import{s as j,p as ie,q as G,v as ae,w as se,f as b,l as g,x as oe,r as le,h as F,y as fe,d as D,z as ce,A as de}from"./useFocusRing-sAzOUMLq.js";import{r as E,e as ue}from"./index-KmaxkdDD.js";import{d as x,c as J,k as pe}from"./utils-HuDI8Qn7.js";import{e as ve,c as X,d as ge,f as $e}from"./platform-COItUIJl.js";import"./index-Ccpfuzew.js";const be=E.createContext({isNative:!0,open:he,useHref:t=>t});function ye(){return E.useContext(be)}function _(t,i,a=!0){var o,f;let{metaKey:p,ctrlKey:v,altKey:u,shiftKey:h}=i;ve()&&(!((f=window.event)===null||f===void 0||(o=f.type)===null||o===void 0)&&o.startsWith("key"))&&t.target==="_blank"&&(X()?p=!0:v=!0);let T=ge()&&X()&&!$e()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:p,ctrlKey:v,altKey:u,shiftKey:h}):new MouseEvent("click",{metaKey:p,ctrlKey:v,altKey:u,shiftKey:h,bubbles:!0,cancelable:!0});_.isOpening=a,j(t),t.dispatchEvent(T),_.isOpening=!1}_.isOpening=!1;function Pe(t,i){if(t instanceof HTMLAnchorElement)i(t);else if(t.hasAttribute("data-href")){let a=document.createElement("a");a.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(a.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(a.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(a.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(a.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(a.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(a),i(a),t.removeChild(a)}}function he(t,i){Pe(t,a=>_(a,i))}function Oe(t){let i=ye();var a;const o=i.useHref((a=t==null?void 0:t.href)!==null&&a!==void 0?a:"");return{href:t!=null&&t.href?o:void 0,target:t==null?void 0:t.target,rel:t==null?void 0:t.rel,download:t==null?void 0:t.download,ping:t==null?void 0:t.ping,referrerPolicy:t==null?void 0:t.referrerPolicy}}const Q=ue.createContext({register:()=>{}});Q.displayName="PressResponderContext";function Te(t,i){return i.get?i.get.call(t):i.value}function Z(t,i,a){if(!i.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return i.get(t)}function Ee(t,i){var a=Z(t,i,"get");return Te(t,a)}function me(t,i){if(i.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,i,a){me(t,i),i.set(t,a)}function ke(t,i,a){if(i.set)i.set.call(t,a);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=a}}function V(t,i,a){var o=Z(t,i,"set");return ke(t,o,a),a}function we(t){let i=E.useContext(Q);if(i){let{register:a,...o}=i;t=J(o,t),a()}return ce(i,t.ref),t}var O=new WeakMap;class L{continuePropagation(){V(this,O,!1)}get shouldStopPropagation(){return Ee(this,O)}constructor(i,a,o,f){xe(this,O,{writable:!0,value:void 0}),V(this,O,!0);var p;let v=(p=f==null?void 0:f.target)!==null&&p!==void 0?p:o.currentTarget;const u=v==null?void 0:v.getBoundingClientRect();let h,T=0,S,y=null;o.clientX!=null&&o.clientY!=null&&(S=o.clientX,y=o.clientY),u&&(S!=null&&y!=null?(h=S-u.left,T=y-u.top):(h=u.width/2,T=u.height/2)),this.type=i,this.pointerType=a,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=h,this.y=T}}const W=Symbol("linkClicked");function Le(t){let{onPress:i,onPressChange:a,onPressStart:o,onPressEnd:f,onPressUp:p,onClick:v,isDisabled:u,isPressed:h,preventFocusOnPress:T,shouldCancelOnPointerExit:S,allowTextSelectionOnPress:y,ref:I,...te}=we(t),[re,z]=E.useState(!1),k=E.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:C,removeAllGlobalListeners:H}=ie(),A=x((e,s)=>{let c=k.current;if(u||c.didFirePressStart)return!1;let r=!0;if(c.isTriggeringEvent=!0,o){let l=new L("pressstart",s,e);o(l),r=l.shouldStopPropagation}return a&&a(!0),c.isTriggeringEvent=!1,c.didFirePressStart=!0,z(!0),r}),w=x((e,s,c=!0)=>{let r=k.current;if(!r.didFirePressStart)return!1;r.didFirePressStart=!1,r.isTriggeringEvent=!0;let l=!0;if(f){let n=new L("pressend",s,e);f(n),l=n.shouldStopPropagation}if(a&&a(!1),z(!1),i&&c&&!u){let n=new L("press",s,e);i(n),l&&(l=n.shouldStopPropagation)}return r.isTriggeringEvent=!1,l}),M=x((e,s)=>{let c=k.current;if(u)return!1;if(p){c.isTriggeringEvent=!0;let r=new L("pressup",s,e);return p(r),c.isTriggeringEvent=!1,r.shouldStopPropagation}return!0}),m=x(e=>{let s=k.current;if(s.isPressed&&s.target){s.didFirePressStart&&s.pointerType!=null&&w(K(s.target,e),s.pointerType,!1),s.isPressed=!1,s.isOverTarget=!1,s.activePointerId=null,s.pointerType=null,H(),y||G(s.target);for(let c of s.disposables)c();s.disposables=[]}}),N=x(e=>{S&&m(e)}),U=x(e=>{v==null||v(e)}),B=x((e,s)=>{if(v){let c=new MouseEvent("click",e);ae(c,s),v(se(c))}}),ne=E.useMemo(()=>{let e=k.current,s={onKeyDown(r){if(R(r.nativeEvent,r.currentTarget)&&b(r.currentTarget,g(r.nativeEvent))){var l;q(g(r.nativeEvent),r.key)&&r.preventDefault();let n=!0;if(!e.isPressed&&!r.repeat){e.target=r.currentTarget,e.isPressed=!0,e.pointerType="keyboard",n=A(r,"keyboard");let d=r.currentTarget,$=P=>{R(P,d)&&!P.repeat&&b(d,g(P))&&e.target&&M(K(e.target,P),"keyboard")};C(F(r.currentTarget),"keyup",pe($,c),!0)}n&&r.stopPropagation(),r.metaKey&&X()&&((l=e.metaKeyEvents)===null||l===void 0||l.set(r.key,r.nativeEvent))}else r.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(r){if(!(r&&!b(r.currentTarget,g(r.nativeEvent)))&&r&&r.button===0&&!e.isTriggeringEvent&&!_.isOpening){let l=!0;if(u&&r.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||de(r.nativeEvent))){let n=A(r,"virtual"),d=M(r,"virtual"),$=w(r,"virtual");U(r),l=n&&d&&$}else if(e.isPressed&&e.pointerType!=="keyboard"){let n=e.pointerType||r.nativeEvent.pointerType||"virtual";l=w(K(r.currentTarget,r),n,!0),e.isOverTarget=!1,U(r),m(r)}e.ignoreEmulatedMouseEvents=!1,l&&r.stopPropagation()}}},c=r=>{var l;if(e.isPressed&&e.target&&R(r,e.target)){var n;q(g(r),r.key)&&r.preventDefault();let $=g(r),P=b(e.target,g(r));w(K(e.target,r),"keyboard",P),P&&B(r,e.target),H(),r.key!=="Enter"&&Y(e.target)&&b(e.target,$)&&!r[W]&&(r[W]=!0,_(e.target,r,!1)),e.isPressed=!1,(n=e.metaKeyEvents)===null||n===void 0||n.delete(r.key)}else if(r.key==="Meta"&&(!((l=e.metaKeyEvents)===null||l===void 0)&&l.size)){var d;let $=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let P of $.values())(d=e.target)===null||d===void 0||d.dispatchEvent(new KeyboardEvent("keyup",P))}};if(typeof PointerEvent<"u"){s.onPointerDown=n=>{if(n.button!==0||!b(n.currentTarget,g(n.nativeEvent)))return;if(oe(n.nativeEvent)){e.pointerType="virtual";return}e.pointerType=n.pointerType;let d=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,y||le(e.target),d=A(n,e.pointerType);let $=g(n.nativeEvent);"releasePointerCapture"in $&&$.releasePointerCapture(n.pointerId),C(F(n.currentTarget),"pointerup",r,!1),C(F(n.currentTarget),"pointercancel",l,!1)}d&&n.stopPropagation()},s.onMouseDown=n=>{if(b(n.currentTarget,g(n.nativeEvent))&&n.button===0){if(T){let d=fe(n.target);d&&e.disposables.push(d)}n.stopPropagation()}},s.onPointerUp=n=>{!b(n.currentTarget,g(n.nativeEvent))||e.pointerType==="virtual"||n.button===0&&M(n,e.pointerType||n.pointerType)},s.onPointerEnter=n=>{n.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,A(K(e.target,n),e.pointerType))},s.onPointerLeave=n=>{n.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,w(K(e.target,n),e.pointerType,!1),N(n))};let r=n=>{if(n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target){if(b(e.target,g(n))&&e.pointerType!=null){let d=!1,$=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(d?m(n):(j(e.target),e.target.click()))},80);C(n.currentTarget,"click",()=>d=!0,!0),e.disposables.push(()=>clearTimeout($))}else m(n);e.isOverTarget=!1}},l=n=>{m(n)};s.onDragStart=n=>{b(n.currentTarget,g(n.nativeEvent))&&m(n)}}return s},[C,u,T,H,y,m,N,w,A,M,U,B]);return E.useEffect(()=>{let e=I==null?void 0:I.current;e&&e instanceof D(e).Element&&D(e).getComputedStyle(e).touchAction==="auto"&&(e.style.touchAction="pan-x pan-y pinch-zoom")},[I]),E.useEffect(()=>{let e=k.current;return()=>{var s;y||G((s=e.target)!==null&&s!==void 0?s:void 0);for(let c of e.disposables)c();e.disposables=[]}},[y]),{isPressed:h||re,pressProps:J(te,ne)}}function Y(t){return t.tagName==="A"&&t.hasAttribute("href")}function R(t,i){const{key:a,code:o}=t,f=i,p=f.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||o==="Space")&&!(f instanceof D(f).HTMLInputElement&&!ee(f,a)||f instanceof D(f).HTMLTextAreaElement||f.isContentEditable)&&!((p==="link"||!p&&Y(f))&&a!=="Enter")}function K(t,i){let a=i.clientX,o=i.clientY;return{currentTarget:t,shiftKey:i.shiftKey,ctrlKey:i.ctrlKey,metaKey:i.metaKey,altKey:i.altKey,clientX:a,clientY:o}}function Ke(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!Y(t)}function q(t,i){return t instanceof HTMLInputElement?!ee(t,i):Ke(t)}const _e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ee(t,i){return t.type==="checkbox"||t.type==="radio"?i===" ":_e.has(t.type)}export{Le as $,xe as _,Oe as a,ye as b,_ as c,Q as d};
