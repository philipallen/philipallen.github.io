import{g as ve,a as Z,b as ge,c as ee,h as Pe,$ as Ke,i as te,j as Se,k as Me,l as Ce}from"./Collection-ZvNUfI9p.js";import{c as H,m as T,d as ke,a as oe,$ as ne,l as Fe,b as z,i as N,g as Ee,f as _e,k as we}from"./utils-l5KLAjAw.js";import{$ as De,a as Ue,b as Q,c as Ie,d as Ve}from"./Separator-CKTcrEJv.js";import{r as d,e as y}from"./index-KmaxkdDD.js";import{a as Ae}from"./Text-DsbvCy5R.js";import{c as E,$ as ae,l as X,x as Te,n as Be}from"./useHover-DDDaVluF.js";import{$ as He}from"./useControlledState-BCPvzKxG.js";import{a as ze,$ as Ne,b as Re}from"./usePress-D8-PWMl6.js";import{a as Oe}from"./FocusScope-um4QTQqo.js";import{a as Le}from"./useOverlayTriggerState-BVShW717.js";const le=new WeakMap;function We(o,e,t){let{shouldFocusWrap:a=!0,onKeyDown:n,onKeyUp:i,...u}=o;!o["aria-label"]&&!o["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=E(o,{labelable:!0}),{listProps:l}=De({...u,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:a,linkBehavior:"override"});return le.set(e,{onClose:o.onClose,onAction:o.onAction,shouldUseVirtualFocus:o.shouldUseVirtualFocus}),{menuProps:H(s,{onKeyDown:n,onKeyUp:i},{role:"menu",...l,onKeyDown:f=>{var c;(f.key!=="Escape"||o.shouldUseVirtualFocus)&&((c=l.onKeyDown)===null||c===void 0||c.call(l,f))}})}}function je(o,e,t){let{id:a,key:n,closeOnSelect:i,isVirtualized:u,"aria-haspopup":s,onPressStart:l,onPressUp:f,onPress:c,onPressChange:$,onPressEnd:h,onHoverStart:b,onHoverChange:g,onHoverEnd:P,onKeyDown:v,onKeyUp:_,onFocus:se,onFocusChange:re,onBlur:ie,selectionManager:m=e.selectionManager}=o,x=!!s,w=x&&o["aria-expanded"]==="true";var D;let K=(D=o.isDisabled)!==null&&D!==void 0?D:m.isDisabled(n);var U;let O=(U=o.isSelected)!==null&&U!==void 0?U:m.isSelected(n),S=le.get(e),p=e.collection.getItem(n),M=o.onClose||S.onClose,de=ze(),I=r=>{var A;if(!x){if(!(p==null||(A=p.props)===null||A===void 0)&&A.onAction?p.props.onAction():o.onAction&&o.onAction(n),S.onAction){let he=S.onAction;he(n)}r.target instanceof HTMLAnchorElement&&p&&de.open(r.target,r,p.props.href,p.props.routerOptions)}},V="menuitem";x||(m.selectionMode==="single"?V="menuitemradio":m.selectionMode==="multiple"&&(V="menuitemcheckbox"));let L=T(),W=T(),j=T(),k={id:a,"aria-disabled":K||void 0,role:V,"aria-label":o["aria-label"],"aria-labelledby":L,"aria-describedby":[W,j].filter(Boolean).join(" ")||void 0,"aria-controls":o["aria-controls"],"aria-haspopup":s,"aria-expanded":o["aria-expanded"]};m.selectionMode!=="none"&&!x&&(k["aria-checked"]=O),u&&(k["aria-posinset"]=p==null?void 0:p.index,k["aria-setsize"]=Ue(e.collection));let ce=r=>{r.pointerType==="keyboard"&&I(r),l==null||l(r)},q=()=>{!x&&M&&(i??(m.selectionMode!=="multiple"||m.isLink(n)))&&M()},ue=r=>{r.pointerType==="mouse"&&(I(r),q()),f==null||f(r)},fe=r=>{r.pointerType!=="keyboard"&&r.pointerType!=="mouse"&&(I(r),q()),c==null||c(r)},{itemProps:C,isFocused:G}=ve({id:a,selectionManager:m,key:n,ref:t,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none",shouldUseVirtualFocus:S.shouldUseVirtualFocus}),{pressProps:be,isPressed:pe}=Ne({onPressStart:ce,onPress:fe,onPressUp:ue,onPressChange:$,onPressEnd:h,isDisabled:K}),{hoverProps:$e}=ae({isDisabled:K,onHoverStart(r){!X()&&!(w&&s)&&(m.setFocused(!0),m.setFocusedKey(n)),b==null||b(r)},onHoverChange:g,onHoverEnd:P}),{keyboardProps:ye}=Te({onKeyDown:r=>{if(r.repeat){r.continuePropagation();return}switch(r.key){case" ":!K&&m.selectionMode==="none"&&!x&&i!==!1&&M&&M();break;case"Enter":!K&&i!==!1&&!x&&M&&M();break;default:x||r.continuePropagation(),v==null||v(r);break}},onKeyUp:_}),{focusProps:me}=Be({onBlur:ie,onFocus:se,onFocusChange:re}),J=E(p==null?void 0:p.props);delete J.id;let xe=Re(p==null?void 0:p.props);return{menuItemProps:{...k,...H(J,xe,x?{onFocus:C.onFocus,"data-collection":C["data-collection"],"data-key":C["data-key"]}:C,be,$e,ye,me,S.shouldUseVirtualFocus||x?{onMouseDown:r=>r.preventDefault()}:void 0),tabIndex:C.tabIndex!=null&&w&&!S.shouldUseVirtualFocus?-1:C.tabIndex},labelProps:{id:L},descriptionProps:{id:W},keyboardShortcutProps:{id:j},isFocused:G,isFocusVisible:G&&m.isFocused&&X()&&!w,isSelected:O,isPressed:pe,isDisabled:K}}function qe(o){let{heading:e,"aria-label":t}=o,a=ke();return{itemProps:{role:"presentation"},headingProps:e?{id:a,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?a:void 0}}}function Ge(o){let e=Le(o),[t,a]=d.useState(null),[n,i]=d.useState([]),u=()=>{i([]),e.close()};return{focusStrategy:t,...e,open(f=null){a(f),e.open()},toggle(f=null){a(f),e.toggle()},close(){u()},expandedKeysStack:n,openSubmenu:(f,c)=>{i($=>c>$.length?$:[...$.slice(0,c),f])},closeSubmenu:(f,c)=>{i($=>$[c]===f?$.slice(0,c):$)}}}class Je{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);var a;return t&&(a=t.prevKey)!==null&&a!==void 0?a:null}getKeyAfter(e){let t=this.keyMap.get(e);var a;return t&&(a=t.nextKey)!==null&&a!==void 0?a:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e,t=t||new Set;let a=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&(s.type==="section"||t.has(s.key)))for(let l of s.childNodes)a(l)};for(let s of e)a(s);let n=null,i=0;for(let[s,l]of this.keyMap)n?(n.nextKey=s,l.prevKey=n.key):(this.firstKey=s,l.prevKey=void 0),l.type==="item"&&(l.index=i++),n=l,n.nextKey=void 0;var u;this.lastKey=(u=n==null?void 0:n.key)!==null&&u!==void 0?u:null}}function Qe(o){let{onExpandedChange:e}=o,[t,a]=He(o.expandedKeys?new Set(o.expandedKeys):void 0,o.defaultExpandedKeys?new Set(o.defaultExpandedKeys):new Set,e),n=Z(o),i=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),u=ge(o,d.useCallback(l=>new Je(l,{expandedKeys:t}),[t]),null);return d.useEffect(()=>{n.focusedKey!=null&&!u.getItem(n.focusedKey)&&n.setFocusedKey(null)},[u,n.focusedKey]),{collection:u,expandedKeys:t,disabledKeys:i,toggleKey:l=>{a(Xe(t,l))},setExpandedKeys:a,selectionManager:new ee(u,n)}}function Xe(o,e){let t=new Set(o);return t.has(e)?t.delete(e):t.add(e),t}const Ye=d.createContext({}),Ze=d.createContext(null),R=d.createContext(null),Y=d.createContext(null),F=d.createContext(null),et=d.createContext(null),pt=d.forwardRef(function(e,t){return[e,t]=oe(e,t,Ze),y.createElement(Pe,{content:y.createElement(Ke,e)},a=>y.createElement(tt,{props:e,collection:a,menuRef:t}))});function tt({props:o,collection:e,menuRef:t}){let{filter:a,collectionProps:n,collectionRef:i}=d.useContext(Q)||{};t=ne(d.useMemo(()=>Fe(t,i!==void 0?i:null),[i,t]));let u=d.useMemo(()=>a?e.UNSTABLE_filter(a):e,[e,a]),s=Qe({...o,collection:u,children:void 0}),l=d.useContext(Y),{isVirtualized:f,CollectionRoot:c}=d.useContext(te),{menuProps:$}=We({...o,...n,isVirtualized:f,onClose:o.onClose||(l==null?void 0:l.close)},s,t),h=z({defaultClassName:"react-aria-Menu",className:o.className,style:o.style,values:{isEmpty:s.collection.size===0}}),b=null;return s.collection.size===0&&o.renderEmptyState&&(b=y.createElement("div",{role:"menuitem",style:{display:"contents"}},o.renderEmptyState())),y.createElement(Oe,null,y.createElement("div",{...E(o),...$,...h,ref:t,slot:o.slot||void 0,"data-empty":s.collection.size===0||void 0,onScroll:o.onScroll},y.createElement(N,{values:[[R,s],[Ie,{elementType:"div"}],[Se,{name:"MenuSection",render:nt}],[et,{parentMenuRef:t,shouldUseVirtualFocus:n==null?void 0:n.shouldUseVirtualFocus}],[B,null],[Q,null],[F,s.selectionManager],[Y,l??Ge({})]]},y.createElement(c,{collection:s.collection,persistedKeys:Me(s.selectionManager.focusedKey),scrollRef:t})),b))}class ot extends ee{get focusedKey(){return this.parent.focusedKey}get isFocused(){return this.parent.isFocused}setFocusedKey(e,t){return this.parent.setFocusedKey(e,t)}setFocused(e){this.parent.setFocused(e)}get childFocusStrategy(){return this.parent.childFocusStrategy}constructor(e,t){super(e.collection,t),this.parent=e}}function nt(o,e,t,a="react-aria-MenuSection"){var n,i;let u=d.useContext(R),{CollectionBranch:s}=d.useContext(te),[l,f]=Ee();var c;let{headingProps:$,groupProps:h}=qe({heading:f,"aria-label":(c=t.props["aria-label"])!==null&&c!==void 0?c:void 0}),b=z({defaultClassName:a,className:(n=t.props)===null||n===void 0?void 0:n.className,style:(i=t.props)===null||i===void 0?void 0:i.style,values:{}}),g=d.useContext(F),P=Z(o),v=o.selectionMode!=null?new ot(g,P):g;return y.createElement("section",{...E(o),...h,...b,ref:e},y.createElement(N,{values:[[Ve,{...$,ref:l}],[F,v]]},y.createElement(s,{collection:u.collection,parent:t})))}const B=d.createContext(null),$t=Ce("item",function(e,t,a){var n;[e,t]=oe(e,t,B);let i=(n=_e(B))===null||n===void 0?void 0:n.id,u=d.useContext(R),s=ne(t),l=d.useContext(F),{menuItemProps:f,labelProps:c,descriptionProps:$,keyboardShortcutProps:h,...b}=je({...e,id:i,key:a.key,selectionManager:l},u,s),{hoverProps:g,isHovered:P}=ae({isDisabled:b.isDisabled}),v=z({...e,id:void 0,children:a.rendered,defaultClassName:"react-aria-MenuItem",values:{...b,isHovered:P,isFocusVisible:b.isFocusVisible,selectionMode:l.selectionMode,selectionBehavior:l.selectionBehavior,hasSubmenu:!!e["aria-haspopup"],isOpen:e["aria-expanded"]==="true"}}),_=e.href?"a":"div";return y.createElement(_,{...H(f,g),...v,ref:s,"data-disabled":b.isDisabled||void 0,"data-hovered":P||void 0,"data-focused":b.isFocused||void 0,"data-focus-visible":b.isFocusVisible||void 0,"data-pressed":b.isPressed||void 0,"data-selected":b.isSelected||void 0,"data-selection-mode":l.selectionMode==="none"?void 0:l.selectionMode,"data-has-submenu":!!e["aria-haspopup"]||void 0,"data-open":e["aria-expanded"]==="true"||void 0},y.createElement(N,{values:[[Ae,{slots:{[we]:c,label:c,description:$}}],[Ye,h]]},v.children))});export{pt as $,$t as a};
