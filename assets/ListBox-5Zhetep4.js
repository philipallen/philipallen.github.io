import{d as ie,e as re,f as N,g as ne,$ as de,h as se,i as ce}from"./Collection-BJBX1VXz.js";import{l as Q,c as V,o as G,k as ue,e as fe,b as _,a as be,$ as K,f as $e,i as X,n as pe}from"./utils-gyFJKyBV.js";import{r as n,e as s}from"./index-KmaxkdDD.js";import{$ as ve,a as ge,b as xe,c as me,d as he,e as Pe}from"./Separator-BQWB5PMu.js";import{a as De}from"./Text-BN8FYGRk.js";import{$ as H}from"./filterDOMProps-CeZl_uWj.js";import{b as ye,$ as Y,o as J,a as Se}from"./useFocusRing-ByLANK_J.js";import{c as Ce}from"./Label-D5Kag7W1.js";import{a as Fe}from"./usePress-C3z6nG1y.js";import{c as we,d as ke}from"./platform-COItUIJl.js";import{$ as Ee,a as Ve}from"./useSingleSelectListState-9FNI6kI1.js";import{c as Me}from"./useNumberFormatter-CsjwgOH6.js";import{b as Ie}from"./Dialog-hSn_xMF0.js";import{a as Be}from"./FocusScope-DVP7JJNc.js";const R=new WeakMap;function Te(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function _e(t,e){let a=R.get(t);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Te(e)}`}function He(t,e,a){let l=H(t,{labelable:!0}),r=t.selectionBehavior||"toggle",i=t.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&i==="action"&&(i="override");let{listProps:o}=ve({...t,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:d}=ye({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),u=Q(t.id);R.set(e,{id:u,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:i});let{labelProps:$,fieldProps:f}=Ce({...t,id:u,labelElementType:"span"});return{labelProps:$,listBoxProps:V(l,d,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...V(f,o)})}}function Le(t,e,a){var l,r;let{key:i}=t,o=R.get(e);var d;let u=(d=t.isDisabled)!==null&&d!==void 0?d:e.selectionManager.isDisabled(i);var $;let f=($=t.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(i);var v;let c=(v=t.shouldSelectOnPressUp)!==null&&v!==void 0?v:o==null?void 0:o.shouldSelectOnPressUp;var g;let m=(g=t.shouldFocusOnHover)!==null&&g!==void 0?g:o==null?void 0:o.shouldFocusOnHover;var x;let p=(x=t.shouldUseVirtualFocus)!==null&&x!==void 0?x:o==null?void 0:o.shouldUseVirtualFocus;var h;let S=(h=t.isVirtualized)!==null&&h!==void 0?h:o==null?void 0:o.isVirtualized,C=G(),M=G(),y={role:"option","aria-disabled":u||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?f:void 0};we()&&ke()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=C,y["aria-describedby"]=M);let b=e.collection.getItem(i);if(S){let D=Number(b==null?void 0:b.index);y["aria-posinset"]=Number.isNaN(D)?void 0:D+1,y["aria-setsize"]=ge(e.collection)}let I=o!=null&&o.onAction?()=>{var D;return o==null||(D=o.onAction)===null||D===void 0?void 0:D.call(o,i)}:void 0,B=_e(e,i),{itemProps:O,isPressed:w,isFocused:P,hasAction:F,allowsSelection:k}=ie({selectionManager:e.selectionManager,key:i,ref:a,shouldSelectOnPressUp:c,allowsDifferentPressOrigin:c&&m,isVirtualized:S,shouldUseVirtualFocus:p,isDisabled:u,onAction:I||!(b==null||(l=b.props)===null||l===void 0)&&l.onAction?ue(b==null||(r=b.props)===null||r===void 0?void 0:r.onAction,I):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:B}),{hoverProps:T}=Y({isDisabled:u||!m,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),E=H(b==null?void 0:b.props);delete E.id;let z=Fe(b==null?void 0:b.props);return{optionProps:{...y,...V(E,O,T,z),id:B},labelProps:{id:C},descriptionProps:{id:M},isFocused:P,isFocusVisible:P&&e.selectionManager.isFocused&&J(),isSelected:f,isDisabled:u,isPressed:w,allowsSelection:k,hasAction:F}}function Ue(t){let{heading:e,"aria-label":a}=t,l=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?l:void 0}}}const L=n.createContext({}),Z=n.createContext(null),Oe=n.forwardRef(function(e,a){let{render:l}=n.useContext(Z);return s.createElement(s.Fragment,null,l(e,a))});function ee(t,e){var a;let l=t==null?void 0:t.renderDropIndicator,r=t==null||(a=t.isVirtualDragging)===null||a===void 0?void 0:a.call(t),i=n.useCallback(o=>{if(r||e!=null&&e.isDropTarget(o))return l?l(o):s.createElement(Oe,{target:o})},[e==null?void 0:e.target,r,l]);return t!=null&&t.useDropIndicator?i:void 0}function ze(t,e,a){var l,r;let i=t.focusedKey,o=null;if(!(e==null||(l=e.isVirtualDragging)===null||l===void 0)&&l.call(e)&&(a==null||(r=a.target)===null||r===void 0?void 0:r.type)==="item"){o=a.target.key;var d;a.target.dropPosition==="after"&&(o=(d=a.collection.getKeyAfter(o))!==null&&d!==void 0?d:o)}return n.useMemo(()=>new Set([i,o].filter(u=>u!=null)),[i,o])}const oe=n.createContext(null),U=n.createContext(null),io=n.forwardRef(function(e,a){[e,a]=be(e,a,oe);let l=n.useContext(U);return l?s.createElement(te,{state:l,props:e,listBoxRef:a}):s.createElement(ne,{content:s.createElement(de,e)},r=>s.createElement(Ae,{props:e,listBoxRef:a,collection:r}))});function Ae({props:t,listBoxRef:e,collection:a}){t={...t,collection:a,children:null,items:null};let{layoutDelegate:l}=n.useContext(N),r=Ee({...t,layoutDelegate:l});return s.createElement(te,{state:r,props:t,listBoxRef:e})}function te({state:t,props:e,listBoxRef:a}){let{filter:l,collectionProps:r,collectionRef:i}=n.useContext(me)||{};e=n.useMemo(()=>r?{...e,...r}:e,[e,r]);let{dragAndDropHooks:o,layout:d="stack",orientation:u="vertical"}=e;a=K(n.useMemo(()=>$e(a,i!==void 0?i:null),[i,a]));let $=Ve(t,l),{collection:f,selectionManager:v}=$,c=!!(o!=null&&o.useDraggableCollectionState),g=!!(o!=null&&o.useDroppableCollectionState),{direction:m}=Me(),{disabledBehavior:x,disabledKeys:p}=v,h=Ie({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:C,dropTargetDelegate:M,CollectionRoot:y}=n.useContext(N),b=n.useMemo(()=>e.keyboardDelegate||new he({collection:f,collator:h,ref:a,disabledKeys:p,disabledBehavior:x,layout:d,orientation:u,direction:m,layoutDelegate:C}),[f,h,a,x,p,u,m,e.keyboardDelegate,d,C]),{listBoxProps:I}=He({...e,shouldSelectOnPressUp:c||e.shouldSelectOnPressUp,keyboardDelegate:b,isVirtualized:S},$,a),B=n.useRef(c),O=n.useRef(g);n.useEffect(()=>{B.current!==c&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),O.current!==g&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[c,g]);let w,P,F,k=!1,T=null,E=n.useRef(null);if(c&&o){w=o.useDraggableCollectionState({collection:f,selectionManager:v,preview:o.renderDragPreview?E:void 0}),o.useDraggableCollection({},w,a);let A=o.DragPreview;T=o.renderDragPreview?s.createElement(A,{ref:E},o.renderDragPreview):null}if(g&&o){P=o.useDroppableCollectionState({collection:f,selectionManager:v});let A=o.dropTargetDelegate||M||new o.ListDropTargetDelegate(f,a,{orientation:u,layout:d,direction:m});F=o.useDroppableCollection({keyboardDelegate:b,dropTargetDelegate:A},P,a),k=P.isDropTarget({type:"root"})}let{focusProps:z,isFocused:D,isFocusVisible:W}=Se(),q={isDropTarget:k,isEmpty:$.collection.size===0,isFocused:D,isFocusVisible:W,layout:e.layout||"stack",state:$},le=_({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:q}),j=null;return $.collection.size===0&&e.renderEmptyState&&(j=s.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(q))),s.createElement(Be,null,s.createElement("div",{...H(e),...V(I,z,F==null?void 0:F.collectionProps),...le,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":k||void 0,"data-empty":$.collection.size===0||void 0,"data-focused":D||void 0,"data-focus-visible":W||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},s.createElement(X,{values:[[oe,e],[U,$],[L,{dragAndDropHooks:o,dragState:w,dropState:P}],[Pe,{elementType:"div"}],[Z,{render:Ne}],[se,{name:"ListBoxSection",render:ae}]]},s.createElement(y,{collection:f,scrollRef:a,persistedKeys:ze(v,o,P),renderDropIndicator:ee(o,P)})),j,T))}function ae(t,e,a,l="react-aria-ListBoxSection"){let r=n.useContext(U),{dragAndDropHooks:i,dropState:o}=n.useContext(L),{CollectionBranch:d}=n.useContext(N),[u,$]=fe();var f;let{headingProps:v,groupProps:c}=Ue({heading:$,"aria-label":(f=t["aria-label"])!==null&&f!==void 0?f:void 0}),g=_({defaultClassName:l,className:t.className,style:t.style,values:{}});return s.createElement("section",{...H(t),...c,...g,ref:e},s.createElement(xe.Provider,{value:{...v,ref:u}},s.createElement(d,{collection:r.collection,parent:a,renderDropIndicator:ee(i,o)})))}const ro=re("section",ae),no=ce("item",function(e,a,l){let r=K(a),i=n.useContext(U),{dragAndDropHooks:o,dragState:d,dropState:u}=n.useContext(L),{optionProps:$,labelProps:f,descriptionProps:v,...c}=Le({key:l.key,"aria-label":e==null?void 0:e["aria-label"]},i,r),{hoverProps:g,isHovered:m}=Y({isDisabled:!c.allowsSelection&&!c.hasAction,onHoverStart:l.props.onHoverStart,onHoverChange:l.props.onHoverChange,onHoverEnd:l.props.onHoverEnd}),x=null;d&&o&&(x=o.useDraggableItem({key:l.key},d));let p=null;u&&o&&(p=o.useDroppableItem({target:{type:"item",key:l.key,dropPosition:"on"}},u,r));let h=d&&d.isDragging(l.key),S=_({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...c,isHovered:m,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!d,isDragging:h,isDropTarget:p==null?void 0:p.isDropTarget}});n.useEffect(()=>{l.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[l.textValue]);let C=e.href?"a":"div";return s.createElement(C,{...V($,g,x==null?void 0:x.dragProps,p==null?void 0:p.dropProps),...S,ref:r,"data-allows-dragging":!!d||void 0,"data-selected":c.isSelected||void 0,"data-disabled":c.isDisabled||void 0,"data-hovered":m||void 0,"data-focused":c.isFocused||void 0,"data-focus-visible":c.isFocusVisible||void 0,"data-pressed":c.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(p==null?void 0:p.isDropTarget)||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},s.createElement(X,{values:[[De,{slots:{[pe]:f,label:f,description:v}}]]},S.children))});function Ne(t,e){e=K(e);let{dragAndDropHooks:a,dropState:l}=n.useContext(L),{dropIndicatorProps:r,isHidden:i,isDropTarget:o}=a.useDropIndicator(t,l,e);return i?null:s.createElement(Re,{...t,dropIndicatorProps:r,isDropTarget:o,ref:e})}function Ke(t,e){let{dropIndicatorProps:a,isDropTarget:l,...r}=t,i=_({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:l}});return s.createElement("div",{...a,...i,role:"option",ref:e,"data-drop-target":l||void 0})}const Re=n.forwardRef(Ke);export{ro as $,io as a,no as b,R as c,_e as d,oe as e,U as f};
