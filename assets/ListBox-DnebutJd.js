import{d as re,e as ne,$ as de,f as N,g as se,h as ce,i as Q}from"./Collection-DeW_zP-L.js";import{e as ue,k as fe,l as X,d as I,o as G,a as $e,b as be,$ as R,g as ve,c as L,j as Y,f as pe,n as ge}from"./utils-BPOuYIA2.js";import{r as d,e as s}from"./index-CcKhGcwW.js";import{p as me,q as xe,r as he,h as Pe,s as De,t as ye,u as Ce}from"./Dialog-fZIrdnKw.js";import{a as Ee}from"./Text-DC2Lycci.js";import{$ as B}from"./filterDOMProps-CeZl_uWj.js";import{a as Me}from"./usePreventScroll-XlKO3Wry.js";import{$ as Ie,a as Fe,b as Se}from"./useSingleSelectListState-CSsfpfh3.js";import{c as we}from"./useNumberFormatter-Be2B0OXy.js";import{b as Ve,$ as Z,a as Le}from"./useFocusRing-G-z0GAlQ.js";import{c as Be}from"./Label-CxUBTwi1.js";import{a as _e}from"./usePress-N-SZRQyW.js";import{p as Oe,q as ke,m as J}from"./focusSafely-B-zcuC90.js";import{a as Te}from"./FocusScope-DImX_wcQ.js";function Ue(t,e){let{collection:a,onLoadMore:l,scrollOffset:r=1}=t,n=d.useRef(null),o=ue(i=>{for(let u of i)u.isIntersecting&&l&&l()});fe(()=>(e.current&&(n.current=new IntersectionObserver(o,{root:Me(e==null?void 0:e.current),rootMargin:`0px ${100*r}% ${100*r}% ${100*r}%`}),n.current.observe(e.current)),()=>{n.current&&n.current.disconnect()}),[a,o,e,r])}const W=new WeakMap;function ze(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Ne(t,e){let a=W.get(t);if(!a)throw new Error("Unknown list");return`${a.id}-option-${ze(e)}`}function He(t,e,a){let l=B(t,{labelable:!0}),r=t.selectionBehavior||"toggle",n=t.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&n==="action"&&(n="override");let{listProps:o}=me({...t,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:n}),{focusWithinProps:i}=Ve({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),u=X(t.id);W.set(e,{id:u,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:n});let{labelProps:p,fieldProps:c}=Be({...t,id:u,labelElementType:"span"});return{labelProps:p,listBoxProps:I(l,i,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...I(c,o)})}}function Ke(t,e,a){var l,r;let{key:n}=t,o=W.get(e);var i;let u=(i=t.isDisabled)!==null&&i!==void 0?i:e.selectionManager.isDisabled(n);var p;let c=(p=t.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(n);var b;let f=(b=t.shouldSelectOnPressUp)!==null&&b!==void 0?b:o==null?void 0:o.shouldSelectOnPressUp;var v;let x=(v=t.shouldFocusOnHover)!==null&&v!==void 0?v:o==null?void 0:o.shouldFocusOnHover;var m;let g=(m=t.shouldUseVirtualFocus)!==null&&m!==void 0?m:o==null?void 0:o.shouldUseVirtualFocus;var h;let D=(h=t.isVirtualized)!==null&&h!==void 0?h:o==null?void 0:o.isVirtualized,M=G(),F=G(),y={role:"option","aria-disabled":u||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};Oe()&&ke()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=M,y["aria-describedby"]=F);let $=e.collection.getItem(n);if(D){let P=Number($==null?void 0:$.index);y["aria-posinset"]=Number.isNaN(P)?void 0:P+1,y["aria-setsize"]=xe(e.collection)}let S=o!=null&&o.onAction?()=>{var P;return o==null||(P=o.onAction)===null||P===void 0?void 0:P.call(o,n)}:void 0,O=Ne(e,n),{itemProps:w,isPressed:C,isFocused:E,hasAction:V,allowsSelection:k}=re({selectionManager:e.selectionManager,key:n,ref:a,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&x,isVirtualized:D,shouldUseVirtualFocus:g,isDisabled:u,onAction:S||!($==null||(l=$.props)===null||l===void 0)&&l.onAction?$e($==null||(r=$.props)===null||r===void 0?void 0:r.onAction,S):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:O}),{hoverProps:T}=Z({isDisabled:u||!x,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(n))}}),U=B($==null?void 0:$.props);delete U.id;let z=_e($==null?void 0:$.props);return{optionProps:{...y,...I(U,w,T,z),id:O},labelProps:{id:M},descriptionProps:{id:F},isFocused:E,isFocusVisible:E&&e.selectionManager.isFocused&&J(),isSelected:c,isDisabled:u,isPressed:C,allowsSelection:k,hasAction:V}}function Ae(t){let{heading:e,"aria-label":a}=t,l=X();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?l:void 0}}}const H=d.createContext({}),ee=d.createContext(null),Re=d.forwardRef(function(e,a){let{render:l}=d.useContext(ee);return s.createElement(s.Fragment,null,l(e,a))});function te(t,e){var a;let l=t==null?void 0:t.renderDropIndicator,r=t==null||(a=t.isVirtualDragging)===null||a===void 0?void 0:a.call(t),n=d.useCallback(o=>{if(r||e!=null&&e.isDropTarget(o))return l?l(o):s.createElement(Re,{target:o})},[e==null?void 0:e.target,r,l]);return t!=null&&t.useDropIndicator?n:void 0}function We(t,e,a){var l,r;let n=t.focusedKey,o=null;if(!(e==null||(l=e.isVirtualDragging)===null||l===void 0)&&l.call(e)&&(a==null||(r=a.target)===null||r===void 0?void 0:r.type)==="item"){o=a.target.key;var i;a.target.dropPosition==="after"&&(o=(i=a.collection.getKeyAfter(o))!==null&&i!==void 0?i:o)}return d.useMemo(()=>new Set([n,o].filter(u=>u!=null)),[n,o])}const oe=d.createContext(null),_=d.createContext(null),ct=d.forwardRef(function(e,a){[e,a]=be(e,a,oe);let l=d.useContext(_);return l?s.createElement(ae,{state:l,props:e,listBoxRef:a}):s.createElement(ne,{content:s.createElement(de,e)},r=>s.createElement(qe,{props:e,listBoxRef:a,collection:r}))});function qe({props:t,listBoxRef:e,collection:a}){t={...t,collection:a,children:null,items:null};let{layoutDelegate:l}=d.useContext(N),r=Ie({...t,layoutDelegate:l});return s.createElement(ae,{state:r,props:t,listBoxRef:e})}function ae({state:t,props:e,listBoxRef:a}){var l;let{filter:r,collectionProps:n,collectionRef:o}=d.useContext(he)||{};e=d.useMemo(()=>n?{...e,...n}:e,[e,n]);let{dragAndDropHooks:i,layout:u="stack",orientation:p="vertical"}=e;a=R(d.useMemo(()=>ve(a,o!==void 0?o:null),[o,a]));let c=Fe(t,r),{collection:b,selectionManager:f}=c,v=!!(i!=null&&i.useDraggableCollectionState),x=!!(i!=null&&i.useDroppableCollectionState),{direction:m}=we(),{disabledBehavior:g,disabledKeys:h}=f,D=Pe({usage:"search",sensitivity:"base"}),{isVirtualized:M,layoutDelegate:F,dropTargetDelegate:y,CollectionRoot:$}=d.useContext(N),S=d.useMemo(()=>e.keyboardDelegate||new De({collection:b,collator:D,ref:a,disabledKeys:h,disabledBehavior:g,layout:u,orientation:p,direction:m,layoutDelegate:F}),[b,D,a,g,h,p,m,e.keyboardDelegate,u,F]),{listBoxProps:O}=He({...e,shouldSelectOnPressUp:v||e.shouldSelectOnPressUp,keyboardDelegate:S,isVirtualized:M},c,a);d.useRef(v),d.useRef(x),d.useEffect(()=>{},[v,x]);let w,C,E,V=!1,k=null,T=d.useRef(null);if(v&&i){w=i.useDraggableCollectionState({collection:b,selectionManager:f,preview:i.renderDragPreview?T:void 0}),i.useDraggableCollection({},w,a);let A=i.DragPreview;k=i.renderDragPreview?s.createElement(A,{ref:T},i.renderDragPreview):null}if(x&&i){C=i.useDroppableCollectionState({collection:b,selectionManager:f});let A=i.dropTargetDelegate||y||new i.ListDropTargetDelegate(b,a,{orientation:p,layout:u,direction:m});E=i.useDroppableCollection({keyboardDelegate:S,dropTargetDelegate:A},C,a),V=C.isDropTarget({type:"root"})}let{focusProps:U,isFocused:z,isFocusVisible:P}=Le(),K=c.collection.size===0||c.collection.size===1&&((l=c.collection.getItem(c.collection.getFirstKey()))===null||l===void 0?void 0:l.type)==="loader",q={isDropTarget:V,isEmpty:K,isFocused:z,isFocusVisible:P,layout:e.layout||"stack",state:c},ie=L({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:q}),j=null;return K&&e.renderEmptyState&&(j=s.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(q))),s.createElement(Te,null,s.createElement("div",{...B(e),...I(O,U,E==null?void 0:E.collectionProps),...ie,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":V||void 0,"data-empty":K||void 0,"data-focused":z||void 0,"data-focus-visible":P||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},s.createElement(Y,{values:[[oe,e],[_,c],[H,{dragAndDropHooks:i,dragState:w,dropState:C}],[ye,{elementType:"div"}],[ee,{render:je}],[se,{name:"ListBoxSection",render:le}]]},s.createElement($,{collection:b,scrollRef:a,persistedKeys:We(f,i,C),renderDropIndicator:te(i,C)})),j,k))}function le(t,e,a,l="react-aria-ListBoxSection"){let r=d.useContext(_),{dragAndDropHooks:n,dropState:o}=d.useContext(H),{CollectionBranch:i}=d.useContext(N),[u,p]=pe();var c;let{headingProps:b,groupProps:f}=Ae({heading:p,"aria-label":(c=t["aria-label"])!==null&&c!==void 0?c:void 0}),v=L({defaultClassName:l,className:t.className,style:t.style,values:{}});return s.createElement("section",{...B(t),...f,...v,ref:e},s.createElement(Ce.Provider,{value:{...b,ref:u}},s.createElement(i,{collection:r.collection,parent:a,renderDropIndicator:te(n,o)})))}const ut=ce("section",le),ft=Q("item",function(e,a,l){let r=R(a),n=d.useContext(_),{dragAndDropHooks:o,dragState:i,dropState:u}=d.useContext(H),{optionProps:p,labelProps:c,descriptionProps:b,...f}=Ke({key:l.key,"aria-label":e==null?void 0:e["aria-label"]},n,r),{hoverProps:v,isHovered:x}=Z({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:l.props.onHoverStart,onHoverChange:l.props.onHoverChange,onHoverEnd:l.props.onHoverEnd}),m=null;i&&o&&(m=o.useDraggableItem({key:l.key},i));let g=null;u&&o&&(g=o.useDroppableItem({target:{type:"item",key:l.key,dropPosition:"on"}},u,r));let h=i&&i.isDragging(l.key),D=L({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:x,selectionMode:n.selectionManager.selectionMode,selectionBehavior:n.selectionManager.selectionBehavior,allowsDragging:!!i,isDragging:h,isDropTarget:g==null?void 0:g.isDropTarget}});d.useEffect(()=>{l.textValue},[l.textValue]);let M=e.href?"a":"div";return s.createElement(M,{...I(p,v,m==null?void 0:m.dragProps,g==null?void 0:g.dropProps),...D,ref:r,"data-allows-dragging":!!i||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":x||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(g==null?void 0:g.isDropTarget)||void 0,"data-selection-mode":n.selectionManager.selectionMode==="none"?void 0:n.selectionManager.selectionMode},s.createElement(Y,{values:[[Ee,{slots:{[ge]:c,label:c,description:b}}]]},D.children))});function je(t,e){e=R(e);let{dragAndDropHooks:a,dropState:l}=d.useContext(H),{dropIndicatorProps:r,isHidden:n,isDropTarget:o}=a.useDropIndicator(t,l,e);return n?null:s.createElement(Je,{...t,dropIndicatorProps:r,isDropTarget:o,ref:e})}function Ge(t,e){let{dropIndicatorProps:a,isDropTarget:l,...r}=t,n=L({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:l}});return s.createElement("div",{...a,...n,role:"option",ref:e,"data-drop-target":l||void 0})}const Je=d.forwardRef(Ge);Q("loader",function(e,a,l){let r=d.useContext(_),{isVirtualized:n}=d.useContext(N),{isLoading:o,onLoadMore:i,scrollOffset:u,...p}=e,c=d.useRef(null),b=d.useMemo(()=>({onLoadMore:i,collection:r==null?void 0:r.collection,sentinelRef:c,scrollOffset:u}),[i,u,r==null?void 0:r.collection]);Ue(b,c);let f=L({...p,id:void 0,children:l.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),v={tabIndex:-1};return n&&(v["aria-posinset"]=l.index+1,v["aria-setsize"]=r.collection.size),s.createElement(s.Fragment,null,s.createElement("div",{style:{position:"relative",width:0,height:0},inert:Se(!0)},s.createElement("div",{"data-testid":"loadMoreSentinel",ref:c,style:{position:"absolute",height:1,width:1}})),o&&f.children&&s.createElement("div",{...I(B(e),v),...f,role:"option",ref:a},f.children))});export{ut as $,ct as a,ft as b,W as c,Ne as d,oe as e,_ as f};
