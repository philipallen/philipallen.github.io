import{b as xe,k as me,a as Ke,c as ee,d as Pe,e as te,f as Ce,$ as De,g as le,l as Me,h as Se,i as we}from"./Collection-HyIYbscu.js";import{f as _,c as ie,x as Fe,h as ke,b as oe,$ as ne,s as _e,e as H,n as U,l as Ne,k as Re,d as Ee}from"./useFocusRing-CELWytXw.js";import{r as d,R as y}from"./index-DH5ua8nC.js";import{a as Ie}from"./Text-X8DQBs4N.js";import{$ as L,e as V,b as Be}from"./useFocusWithin-Dp0pJUJ1.js";import{$ as J}from"./isScrollable-BSEN4xi5.js";import{$ as Ae}from"./useCollator-C1eRjvOk.js";import{b as Ve,$ as ze,a as He}from"./usePress-DAUyqWol.js";import{$ as Ue}from"./useKeyboard-BZGC9FVW.js";import{$ as Le}from"./useControlledState-BSXamw7l.js";import{a as Te}from"./FocusScope-DBUbNCbs.js";class Q{getItemRect(e){let t=this.ref.current;if(!t)return null;let l=e!=null?t.querySelector(`[data-key="${CSS.escape(e.toString())}"]`):null;if(!l)return null;let i=t.getBoundingClientRect(),n=l.getBoundingClientRect();return{x:n.left-i.left+t.scrollLeft,y:n.top-i.top+t.scrollTop,width:n.width,height:n.height}}getContentSize(){let e=this.ref.current;var t,l;return{width:(t=e==null?void 0:e.scrollWidth)!==null&&t!==void 0?t:0,height:(l=e==null?void 0:e.scrollHeight)!==null&&l!==void 0?l:0}}getVisibleRect(){let e=this.ref.current;var t,l,i,n;return{x:(t=e==null?void 0:e.scrollLeft)!==null&&t!==void 0?t:0,y:(l=e==null?void 0:e.scrollTop)!==null&&l!==void 0?l:0,width:(i=e==null?void 0:e.offsetWidth)!==null&&i!==void 0?i:0,height:(n=e==null?void 0:e.offsetHeight)!==null&&n!==void 0?n:0}}constructor(e){this.ref=e}}class Oe{isDisabled(e){var t;return this.disabledBehavior==="all"&&(((t=e.props)===null||t===void 0?void 0:t.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,t){let l=e;for(;l!=null;){let i=this.collection.getItem(l);if((i==null?void 0:i.type)==="item"&&!this.isDisabled(i))return l;l=t(l)}return null}getNextKey(e){let t=e;return t=this.collection.getKeyAfter(t),this.findNextNonDisabled(t,l=>this.collection.getKeyAfter(l))}getPreviousKey(e){let t=e;return t=this.collection.getKeyBefore(t),this.findNextNonDisabled(t,l=>this.collection.getKeyBefore(l))}findKey(e,t,l){let i=e,n=this.layoutDelegate.getItemRect(i);if(!n||i==null)return null;let r=n;do{if(i=t(i),i==null)break;n=this.layoutDelegate.getItemRect(i)}while(n&&l(r,n)&&i!=null);return i}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getNextKey(t),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getPreviousKey(t),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let t=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let t=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyAfter(t))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyBefore(t))}getKeyPageAbove(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(t&&!J(t))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let n=Math.max(0,l.x+l.width-this.layoutDelegate.getVisibleRect().width);for(;l&&l.x>n&&i!=null;)i=this.getKeyAbove(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}else{let n=Math.max(0,l.y+l.height-this.layoutDelegate.getVisibleRect().height);for(;l&&l.y>n&&i!=null;)i=this.getKeyAbove(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(t&&!J(t))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let n=Math.min(this.layoutDelegate.getContentSize().width,l.y-l.width+this.layoutDelegate.getVisibleRect().width);for(;l&&l.x<n&&i!=null;)i=this.getKeyBelow(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}else{let n=Math.min(this.layoutDelegate.getContentSize().height,l.y-l.height+this.layoutDelegate.getVisibleRect().height);for(;l&&l.y<n&&i!=null;)i=this.getKeyBelow(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let l=this.collection,i=t||this.getFirstKey();for(;i!=null;){let n=l.getItem(i);if(!n)return null;let r=n.textValue.slice(0,e.length);if(n.textValue&&this.collator.compare(r,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||"all",this.orientation=t.orientation||"vertical",this.direction=t.direction,this.layout=t.layout||"stack",this.layoutDelegate=t.layoutDelegate||new Q(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new Q(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function We(o){let{selectionManager:e,collection:t,disabledKeys:l,ref:i,keyboardDelegate:n,layoutDelegate:r}=o,s=Ae({usage:"search",sensitivity:"base"}),a=e.disabledBehavior,h=d.useMemo(()=>n||new Oe({collection:t,disabledKeys:l,disabledBehavior:a,ref:i,collator:s,layoutDelegate:r}),[n,r,t,l,i,s,a]),{collectionProps:u}=xe({...o,ref:i,selectionManager:e,keyboardDelegate:h});return{listProps:u}}const Z=new WeakMap;function qe(o){let e=Z.get(o);if(e!=null)return e;let t=0,l=i=>{for(let n of i)n.type==="section"?l(me(n,o)):t++};return l(o),Z.set(o,t),t}const ae=new WeakMap;function Xe(o,e,t){let{shouldFocusWrap:l=!0,onKeyDown:i,onKeyUp:n,...r}=o;!o["aria-label"]&&!o["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=_(o,{labelable:!0}),{listProps:a}=We({...r,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:l,linkBehavior:"override"});return ae.set(e,{onClose:o.onClose,onAction:o.onAction,shouldUseVirtualFocus:o.shouldUseVirtualFocus}),{menuProps:L(s,{onKeyDown:i,onKeyUp:n},{role:"menu",...a,onKeyDown:h=>{var u;(h.key!=="Escape"||o.shouldUseVirtualFocus)&&((u=a.onKeyDown)===null||u===void 0||u.call(a,h))}})}}function Ye(o,e,t){let{id:l,key:i,closeOnSelect:n,isVirtualized:r,"aria-haspopup":s,onPressStart:a,onPressUp:h,onPress:u,onPressChange:$,onPressEnd:v,onHoverStart:b,onHoverChange:x,onHoverEnd:C,onKeyDown:m,onKeyUp:M,onFocus:S,onFocusChange:N,onBlur:se,selectionManager:g=e.selectionManager}=o,p=!!s,O=p&&o["aria-expanded"]==="true";var R;let K=(R=o.isDisabled)!==null&&R!==void 0?R:g.isDisabled(i);var E;let W=(E=o.isSelected)!==null&&E!==void 0?E:g.isSelected(i),w=ae.get(e),f=e.collection.getItem(i),P=o.onClose||w.onClose,re=Ve(),I=c=>{var A;if(!p){if(!(f==null||(A=f.props)===null||A===void 0)&&A.onAction?f.props.onAction():o.onAction&&o.onAction(i),w.onAction){let ve=w.onAction;ve(i)}c.target instanceof HTMLAnchorElement&&f&&re.open(c.target,c,f.props.href,f.props.routerOptions)}},B="menuitem";p||(g.selectionMode==="single"?B="menuitemradio":g.selectionMode==="multiple"&&(B="menuitemcheckbox"));let q=V(),X=V(),Y=V(),F={id:l,"aria-disabled":K||void 0,role:B,"aria-label":o["aria-label"],"aria-labelledby":q,"aria-describedby":[X,Y].filter(Boolean).join(" ")||void 0,"aria-controls":o["aria-controls"],"aria-haspopup":s,"aria-expanded":o["aria-expanded"]};g.selectionMode!=="none"&&!p&&(F["aria-checked"]=W),r&&(F["aria-posinset"]=f==null?void 0:f.index,F["aria-setsize"]=qe(e.collection));let de=c=>{c.pointerType==="keyboard"&&I(c),a==null||a(c)},j=()=>{!p&&P&&(n??(g.selectionMode!=="multiple"||g.isLink(i)))&&P()},ce=c=>{c.pointerType==="mouse"&&(I(c),j()),h==null||h(c)},ue=c=>{c.pointerType!=="keyboard"&&c.pointerType!=="mouse"&&(I(c),j()),u==null||u(c)},{itemProps:D,isFocused:fe}=Ke({id:l,selectionManager:g,key:i,ref:t,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none",shouldUseVirtualFocus:w.shouldUseVirtualFocus}),{pressProps:he,isPressed:be}=ze({onPressStart:de,onPress:ue,onPressUp:ce,onPressChange:$,onPressEnd:v,isDisabled:K}),{hoverProps:ye}=ie({isDisabled:K,onHoverStart(c){!Fe()&&!(O&&s==="dialog")&&(g.setFocused(!0),g.setFocusedKey(i)),b==null||b(c)},onHoverChange:x,onHoverEnd:C}),{keyboardProps:ge}=Ue({onKeyDown:c=>{if(c.repeat){c.continuePropagation();return}switch(c.key){case" ":!K&&g.selectionMode==="none"&&!p&&n!==!1&&P&&P();break;case"Enter":!K&&n!==!1&&!p&&P&&P();break;default:p||c.continuePropagation(),m==null||m(c);break}},onKeyUp:M}),{focusProps:pe}=ke({onBlur:se,onFocus:S,onFocusChange:N}),G=_(f==null?void 0:f.props);delete G.id;let $e=He(f==null?void 0:f.props);return{menuItemProps:{...F,...L(G,$e,p?{onFocus:D.onFocus,"data-key":D["data-key"]}:D,he,ye,ge,pe),tabIndex:D.tabIndex!=null&&O?-1:D.tabIndex},labelProps:{id:q},descriptionProps:{id:X},keyboardShortcutProps:{id:Y},isFocused:fe,isSelected:W,isPressed:be,isDisabled:K}}function je(o){let{heading:e,"aria-label":t}=o,l=Be();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?l:void 0}}}class Ge{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);var l;return t&&(l=t.prevKey)!==null&&l!==void 0?l:null}getKeyAfter(e){let t=this.keyMap.get(e);var l;return t&&(l=t.nextKey)!==null&&l!==void 0?l:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e,t=t||new Set;let l=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&(s.type==="section"||t.has(s.key)))for(let a of s.childNodes)l(a)};for(let s of e)l(s);let i=null,n=0;for(let[s,a]of this.keyMap)i?(i.nextKey=s,a.prevKey=i.key):(this.firstKey=s,a.prevKey=void 0),a.type==="item"&&(a.index=n++),i=a,i.nextKey=void 0;var r;this.lastKey=(r=i==null?void 0:i.key)!==null&&r!==void 0?r:null}}function Je(o){let{onExpandedChange:e}=o,[t,l]=Le(o.expandedKeys?new Set(o.expandedKeys):void 0,o.defaultExpandedKeys?new Set(o.defaultExpandedKeys):new Set,e),i=ee(o),n=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),r=Pe(o,d.useCallback(a=>new Ge(a,{expandedKeys:t}),[t]),null);return d.useEffect(()=>{i.focusedKey!=null&&!r.getItem(i.focusedKey)&&i.setFocusedKey(null)},[r,i.focusedKey]),{collection:r,expandedKeys:t,disabledKeys:n,toggleKey:a=>{l(Qe(t,a))},setExpandedKeys:l,selectionManager:new te(r,i)}}function Qe(o,e){let t=new Set(o);return t.has(e)?t.delete(e):t.add(e),t}const Ze=d.createContext(null),et=d.createContext({}),tt=d.createContext({}),lt=d.createContext({}),it=d.createContext(null),T=d.createContext(null),ot=d.createContext(null),k=d.createContext(null),nt=d.createContext(null),xt=d.forwardRef(function(e,t){return[e,t]=oe(e,t,it),y.createElement(Ce,{content:y.createElement(De,e)},l=>l.size>0&&y.createElement(at,{props:e,collection:l,menuRef:t}))});function at({props:o,collection:e,menuRef:t}){let{filterFn:l,collectionProps:i,collectionRef:n}=d.useContext(Ze)||{};t=ne(d.useMemo(()=>_e(t,n!==void 0?n:null),[n,t]));let r=d.useMemo(()=>l?e.filter(l):e,[e,l]),s=Je({...o,collection:r,children:void 0}),a=d.useContext(ot),{isVirtualized:h,CollectionRoot:u}=d.useContext(le),{menuProps:$}=Xe({...o,...i,isVirtualized:h,onClose:o.onClose||(a==null?void 0:a.close)},s,t),v=H({defaultClassName:"react-aria-Menu",className:o.className,style:o.style,values:{}});return y.createElement(Te,null,y.createElement("div",{..._(o),...$,...v,ref:t,slot:o.slot||void 0,onScroll:o.onScroll},y.createElement(U,{values:[[T,s],[tt,{elementType:"div"}],[Me,{name:"MenuSection",render:rt}],[nt,{parentMenuRef:t}],[z,null],[k,s.selectionManager]]},y.createElement(u,{collection:s.collection,persistedKeys:Se(s.selectionManager.focusedKey),scrollRef:t}))))}class st extends te{get focusedKey(){return this.parent.focusedKey}get isFocused(){return this.parent.isFocused}setFocusedKey(e,t){return this.parent.setFocusedKey(e,t)}setFocused(e){this.parent.setFocused(e)}get childFocusStrategy(){return this.parent.childFocusStrategy}constructor(e,t){super(e.collection,t),this.parent=e}}function rt(o,e,t,l="react-aria-MenuSection"){var i,n;let r=d.useContext(T),{CollectionBranch:s}=d.useContext(le),[a,h]=Ne();var u;let{headingProps:$,groupProps:v}=je({heading:h,"aria-label":(u=t.props["aria-label"])!==null&&u!==void 0?u:void 0}),b=H({defaultClassName:l,className:(i=t.props)===null||i===void 0?void 0:i.className,style:(n=t.props)===null||n===void 0?void 0:n.style,values:{}}),x=d.useContext(k),C=ee(o),m=o.selectionMode!=null?new st(x,C):x;return y.createElement("section",{..._(o),...v,...b,ref:e},y.createElement(U,{values:[[et,{...$,ref:a}],[k,m]]},y.createElement(s,{collection:r.collection,parent:t})))}const z=d.createContext(null),mt=we("item",function(e,t,l){var i;[e,t]=oe(e,t,z);let n=(i=Re(z))===null||i===void 0?void 0:i.id,r=d.useContext(T),s=ne(t),a=d.useContext(k),{menuItemProps:h,labelProps:u,descriptionProps:$,keyboardShortcutProps:v,...b}=Ye({...e,id:n,key:l.key,selectionManager:a},r,s),{isFocusVisible:x,focusProps:C}=Ee(),{hoverProps:m,isHovered:M}=ie({isDisabled:b.isDisabled}),S=H({...e,id:void 0,children:l.rendered,defaultClassName:"react-aria-MenuItem",values:{...b,isHovered:M,isFocusVisible:x,selectionMode:a.selectionMode,selectionBehavior:a.selectionBehavior,hasSubmenu:!!e["aria-haspopup"],isOpen:e["aria-expanded"]==="true"}}),N=e.href?"a":"div";return y.createElement(N,{...L(h,C,m),...S,ref:s,"data-disabled":b.isDisabled||void 0,"data-hovered":M||void 0,"data-focused":b.isFocused||void 0,"data-focus-visible":x||void 0,"data-pressed":b.isPressed||void 0,"data-selected":b.isSelected||void 0,"data-selection-mode":a.selectionMode==="none"?void 0:a.selectionMode,"data-has-submenu":!!e["aria-haspopup"]||void 0,"data-open":e["aria-expanded"]==="true"||void 0},y.createElement(U,{values:[[Ie,{slots:{label:u,description:$}}],[lt,v]]},S.children))});export{xt as $,mt as a};
