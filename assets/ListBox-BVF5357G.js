import{d as ae,e as le,f as K,g as ie,$ as re,h as de,i as ne}from"./Collection-XH8ulj08.js";import{l as G,c as V,o as q,k as se,e as ce,b as L,a as ue,$ as A,f as fe,i as J,n as $e}from"./utils-HuDI8Qn7.js";import{r as d,e as s}from"./index-KmaxkdDD.js";import{$ as be,a as ve,b as pe,c as ge,d as me,e as xe}from"./Separator-DLiRVzmN.js";import{a as he}from"./Text-_8HeSx-x.js";import{$ as U}from"./filterDOMProps-CeZl_uWj.js";import{b as Pe,$ as Q,o as j,a as De}from"./useFocusRing-sAzOUMLq.js";import{c as ye}from"./Label-B4tzsfJl.js";import{a as Ce}from"./usePress-BpjTE7Om.js";import{c as Ee,d as Se}from"./platform-COItUIJl.js";import{$ as Fe,a as we}from"./useSingleSelectListState-jiLWQ0yE.js";import{c as Me}from"./useNumberFormatter-0Jg9Jb_k.js";import{b as Ve}from"./Dialog-7WXOo05O.js";import{a as Ie}from"./FocusScope-U4VFcwgb.js";const W=new WeakMap;function Be(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function ke(o,e){let a=W.get(o);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Be(e)}`}function _e(o,e,a){let l=U(o,{labelable:!0}),r=o.selectionBehavior||"toggle",i=o.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&i==="action"&&(i="override");let{listProps:t}=be({...o,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:n}=Pe({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),c=G(o.id);W.set(e,{id:c,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:i});let{labelProps:b,fieldProps:u}=ye({...o,id:c,labelElementType:"span"});return{labelProps:b,listBoxProps:V(l,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...V(u,t)})}}function Te(o,e,a){var l,r;let{key:i}=o,t=W.get(e);var n;let c=(n=o.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(i);var b;let u=(b=o.isSelected)!==null&&b!==void 0?b:e.selectionManager.isSelected(i);var p;let f=(p=o.shouldSelectOnPressUp)!==null&&p!==void 0?p:t==null?void 0:t.shouldSelectOnPressUp;var g;let x=(g=o.shouldFocusOnHover)!==null&&g!==void 0?g:t==null?void 0:t.shouldFocusOnHover;var m;let v=(m=o.shouldUseVirtualFocus)!==null&&m!==void 0?m:t==null?void 0:t.shouldUseVirtualFocus;var h;let C=(h=o.isVirtualized)!==null&&h!==void 0?h:t==null?void 0:t.isVirtualized,E=q(),I=q(),D={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?u:void 0};Ee()&&Se()||(D["aria-label"]=o["aria-label"],D["aria-labelledby"]=E,D["aria-describedby"]=I);let $=e.collection.getItem(i);if(C){let P=Number($==null?void 0:$.index);D["aria-posinset"]=Number.isNaN(P)?void 0:P+1,D["aria-setsize"]=ve(e.collection)}let B=t!=null&&t.onAction?()=>{var P;return t==null||(P=t.onAction)===null||P===void 0?void 0:P.call(t,i)}:void 0,S=ke(e,i),{itemProps:y,isPressed:F,isFocused:w,hasAction:k,allowsSelection:_}=ae({selectionManager:e.selectionManager,key:i,ref:a,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&x,isVirtualized:C,shouldUseVirtualFocus:v,isDisabled:c,onAction:B||!($==null||(l=$.props)===null||l===void 0)&&l.onAction?se($==null||(r=$.props)===null||r===void 0?void 0:r.onAction,B):void 0,linkBehavior:t==null?void 0:t.linkBehavior,id:S}),{hoverProps:N}=Q({isDisabled:c||!x,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),M=U($==null?void 0:$.props);delete M.id;let T=Ce($==null?void 0:$.props);return{optionProps:{...D,...V(M,y,N,T),id:S},labelProps:{id:E},descriptionProps:{id:I},isFocused:w,isFocusVisible:w&&e.selectionManager.isFocused&&j(),isSelected:u,isDisabled:c,isPressed:F,allowsSelection:_,hasAction:k}}function Le(o){let{heading:e,"aria-label":a}=o,l=G();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?l:void 0}}}const O=d.createContext({}),X=d.createContext(null),Ue=d.forwardRef(function(e,a){let{render:l}=d.useContext(X);return s.createElement(s.Fragment,null,l(e,a))});function Y(o,e){var a;let l=o==null?void 0:o.renderDropIndicator,r=o==null||(a=o.isVirtualDragging)===null||a===void 0?void 0:a.call(o),i=d.useCallback(t=>{if(r||e!=null&&e.isDropTarget(t))return l?l(t):s.createElement(Ue,{target:t})},[e==null?void 0:e.target,r,l]);return o!=null&&o.useDropIndicator?i:void 0}function Oe(o,e,a){var l,r;let i=o.focusedKey,t=null;if(!(e==null||(l=e.isVirtualDragging)===null||l===void 0)&&l.call(e)&&(a==null||(r=a.target)===null||r===void 0?void 0:r.type)==="item"){t=a.target.key;var n;a.target.dropPosition==="after"&&(t=(n=a.collection.getKeyAfter(t))!==null&&n!==void 0?n:t)}return d.useMemo(()=>new Set([i,t].filter(c=>c!=null)),[i,t])}const Z=d.createContext(null),z=d.createContext(null),at=d.forwardRef(function(e,a){[e,a]=ue(e,a,Z);let l=d.useContext(z);return l?s.createElement(ee,{state:l,props:e,listBoxRef:a}):s.createElement(ie,{content:s.createElement(re,e)},r=>s.createElement(ze,{props:e,listBoxRef:a,collection:r}))});function ze({props:o,listBoxRef:e,collection:a}){o={...o,collection:a,children:null,items:null};let{layoutDelegate:l}=d.useContext(K),r=Fe({...o,layoutDelegate:l});return s.createElement(ee,{state:r,props:o,listBoxRef:e})}function ee({state:o,props:e,listBoxRef:a}){let{filter:l,collectionProps:r,collectionRef:i}=d.useContext(ge)||{};e=d.useMemo(()=>r?{...e,...r}:e,[e,r]);let{dragAndDropHooks:t,layout:n="stack",orientation:c="vertical"}=e;a=A(d.useMemo(()=>fe(a,i!==void 0?i:null),[i,a]));let b=we(o,l),{collection:u,selectionManager:p}=b,f=!!(t!=null&&t.useDraggableCollectionState),g=!!(t!=null&&t.useDroppableCollectionState),{direction:x}=Me(),{disabledBehavior:m,disabledKeys:v}=p,h=Ve({usage:"search",sensitivity:"base"}),{isVirtualized:C,layoutDelegate:E,dropTargetDelegate:I,CollectionRoot:D}=d.useContext(K),$=d.useMemo(()=>e.keyboardDelegate||new me({collection:u,collator:h,ref:a,disabledKeys:v,disabledBehavior:m,layout:n,orientation:c,direction:x,layoutDelegate:E}),[u,h,a,m,v,c,x,e.keyboardDelegate,n,E]),{listBoxProps:B}=_e({...e,shouldSelectOnPressUp:f||e.shouldSelectOnPressUp,keyboardDelegate:$,isVirtualized:C},b,a);d.useRef(f),d.useRef(g),d.useEffect(()=>{},[f,g]);let S,y,F,w=!1,k=null,_=d.useRef(null);if(f&&t){S=t.useDraggableCollectionState({collection:u,selectionManager:p,preview:t.renderDragPreview?_:void 0}),t.useDraggableCollection({},S,a);let H=t.DragPreview;k=t.renderDragPreview?s.createElement(H,{ref:_},t.renderDragPreview):null}if(g&&t){y=t.useDroppableCollectionState({collection:u,selectionManager:p});let H=t.dropTargetDelegate||I||new t.ListDropTargetDelegate(u,a,{orientation:c,layout:n,direction:x});F=t.useDroppableCollection({keyboardDelegate:$,dropTargetDelegate:H},y,a),w=y.isDropTarget({type:"root"})}let{focusProps:N,isFocused:M,isFocusVisible:T}=De(),P={isDropTarget:w,isEmpty:b.collection.size===0,isFocused:M,isFocusVisible:T,layout:e.layout||"stack",state:b},oe=L({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:P}),R=null;return b.collection.size===0&&e.renderEmptyState&&(R=s.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(P))),s.createElement(Ie,null,s.createElement("div",{...U(e),...V(B,N,F==null?void 0:F.collectionProps),...oe,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":b.collection.size===0||void 0,"data-focused":M||void 0,"data-focus-visible":T||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},s.createElement(J,{values:[[Z,e],[z,b],[O,{dragAndDropHooks:t,dragState:S,dropState:y}],[xe,{elementType:"div"}],[X,{render:Ne}],[de,{name:"ListBoxSection",render:te}]]},s.createElement(D,{collection:u,scrollRef:a,persistedKeys:Oe(p,t,y),renderDropIndicator:Y(t,y)})),R,k))}function te(o,e,a,l="react-aria-ListBoxSection"){let r=d.useContext(z),{dragAndDropHooks:i,dropState:t}=d.useContext(O),{CollectionBranch:n}=d.useContext(K),[c,b]=ce();var u;let{headingProps:p,groupProps:f}=Le({heading:b,"aria-label":(u=o["aria-label"])!==null&&u!==void 0?u:void 0}),g=L({defaultClassName:l,className:o.className,style:o.style,values:{}});return s.createElement("section",{...U(o),...f,...g,ref:e},s.createElement(pe.Provider,{value:{...p,ref:c}},s.createElement(n,{collection:r.collection,parent:a,renderDropIndicator:Y(i,t)})))}const lt=le("section",te),it=ne("item",function(e,a,l){let r=A(a),i=d.useContext(z),{dragAndDropHooks:t,dragState:n,dropState:c}=d.useContext(O),{optionProps:b,labelProps:u,descriptionProps:p,...f}=Te({key:l.key,"aria-label":e==null?void 0:e["aria-label"]},i,r),{hoverProps:g,isHovered:x}=Q({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:l.props.onHoverStart,onHoverChange:l.props.onHoverChange,onHoverEnd:l.props.onHoverEnd}),m=null;n&&t&&(m=t.useDraggableItem({key:l.key},n));let v=null;c&&t&&(v=t.useDroppableItem({target:{type:"item",key:l.key,dropPosition:"on"}},c,r));let h=n&&n.isDragging(l.key),C=L({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:x,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:h,isDropTarget:v==null?void 0:v.isDropTarget}});d.useEffect(()=>{l.textValue},[l.textValue]);let E=e.href?"a":"div";return s.createElement(E,{...V(b,g,m==null?void 0:m.dragProps,v==null?void 0:v.dropProps),...C,ref:r,"data-allows-dragging":!!n||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":x||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(v==null?void 0:v.isDropTarget)||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},s.createElement(J,{values:[[he,{slots:{[$e]:u,label:u,description:p}}]]},C.children))});function Ne(o,e){e=A(e);let{dragAndDropHooks:a,dropState:l}=d.useContext(O),{dropIndicatorProps:r,isHidden:i,isDropTarget:t}=a.useDropIndicator(o,l,e);return i?null:s.createElement(Ke,{...o,dropIndicatorProps:r,isDropTarget:t,ref:e})}function He(o,e){let{dropIndicatorProps:a,isDropTarget:l,...r}=o,i=L({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:l}});return s.createElement("div",{...a,...i,role:"option",ref:e,"data-drop-target":l||void 0})}const Ke=d.forwardRef(He);export{lt as $,at as a,it as b,W as c,ke as d,Z as e,z as f};
