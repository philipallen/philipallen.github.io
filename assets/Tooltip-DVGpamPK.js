import{m as H,d as O,l as I,j as L,b as k,k as B,c as F}from"./utils-BPOuYIA2.js";import{i as W,j as A,k as N,l as U,m as _,n as j}from"./Dialog-D7L8ikGJ.js";import{$ as w,c as K,d as V}from"./useFocusRing-G-z0GAlQ.js";import{e as f,r as a}from"./index-CcKhGcwW.js";import{l as z,m as Y}from"./focusSafely-B-zcuC90.js";import{$ as q}from"./filterDOMProps-CeZl_uWj.js";import{$ as G}from"./index-uaANFLeC.js";const C=f.createContext(null);function J(t){let{children:r}=t,e=a.useContext(C),[n,i]=a.useState(0),c=a.useMemo(()=>({parent:e,modalCount:n,addModal(){i(l=>l+1),e&&e.addModal()},removeModal(){i(l=>l-1),e&&e.removeModal()}}),[e,n]);return f.createElement(C.Provider,{value:c},r)}function Q(){let t=a.useContext(C);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function X(t){let{modalProviderProps:r}=Q();return f.createElement("div",{"data-overlay-container":!0,...t,...r})}function Z(t){return f.createElement(J,null,f.createElement(X,t))}function ee(t){let r=H(),{portalContainer:e=r?null:document.body,...n}=t,{getContainer:i}=W();if(!t.portalContainer&&i&&(e=i()),f.useEffect(()=>{if(e!=null&&e.closest("[data-overlay-container]"))throw new Error("An OverlayContainer must not be inside another container. Please change the portalContainer prop.")},[e]),!e)return null;let c=f.createElement(Z,n);return G.createPortal(c,e)}function te(t,r){let e=q(t,{labelable:!0}),{hoverProps:n}=w({onHoverStart:()=>r==null?void 0:r.open(!0),onHoverEnd:()=>r==null?void 0:r.close()});return{tooltipProps:O(e,n,{role:"tooltip"})}}function re(t,r,e){let{isDisabled:n,trigger:i}=t,c=I(),l=a.useRef(!1),o=a.useRef(!1),s=()=>{(l.current||o.current)&&r.open(o.current)},d=P=>{!l.current&&!o.current&&r.close(P)};a.useEffect(()=>{let P=h=>{e&&e.current&&h.key==="Escape"&&(h.stopPropagation(),r.close(!0))};if(r.isOpen)return document.addEventListener("keydown",P,!0),()=>{document.removeEventListener("keydown",P,!0)}},[e,r]);let m=()=>{i!=="focus"&&(z()==="pointer"?l.current=!0:l.current=!1,s())},x=()=>{i!=="focus"&&(o.current=!1,l.current=!1,d())},v=()=>{o.current=!1,l.current=!1,d(!0)},E=()=>{Y()&&(o.current=!0,s())},u=()=>{o.current=!1,l.current=!1,d(!0)},{hoverProps:D}=w({isDisabled:n,onHoverStart:m,onHoverEnd:x}),{focusableProps:M}=K({isDisabled:n,onFocus:E,onBlur:u},e);return{triggerProps:{"aria-describedby":r.isOpen?c:void 0,...O(M,D,{onPointerDown:v,onKeyDown:v,tabIndex:void 0})},tooltipProps:{id:c}}}const oe=1500,y=500;let p={},le=0,g=!1,$=null,b=null;function R(t={}){let{delay:r=oe,closeDelay:e=y}=t,{isOpen:n,open:i,close:c}=A(t),l=a.useMemo(()=>`${++le}`,[]),o=a.useRef(null),s=a.useRef(c),d=()=>{p[l]=v},m=()=>{for(let u in p)u!==l&&(p[u](!0),delete p[u])},x=()=>{o.current&&clearTimeout(o.current),o.current=null,m(),d(),g=!0,i(),$&&(clearTimeout($),$=null),b&&(clearTimeout(b),b=null)},v=u=>{u||e<=0?(o.current&&clearTimeout(o.current),o.current=null,s.current()):o.current||(o.current=setTimeout(()=>{o.current=null,s.current()},e)),$&&(clearTimeout($),$=null),g&&(b&&clearTimeout(b),b=setTimeout(()=>{delete p[l],b=null,g=!1},Math.max(y,e)))},E=()=>{m(),d(),!n&&!$&&!g?$=setTimeout(()=>{$=null,g=!0,x()},r):n||x()};return a.useEffect(()=>{s.current=c},[c]),a.useEffect(()=>()=>{o.current&&clearTimeout(o.current),p[l]&&delete p[l]},[l]),{isOpen:n,open:u=>{!u&&r>0&&!o.current?E():x()},close:v}}const T=a.createContext(null),S=a.createContext(null);function $e(t){let r=R(t),e=a.useRef(null),{triggerProps:n,tooltipProps:i}=re(t,r,e);return f.createElement(L,{values:[[T,r],[S,{...i,triggerRef:e}]]},f.createElement(V,{...n,ref:e},t.children))}const pe=a.forwardRef(function({UNSTABLE_portalContainer:r,...e},n){[e,n]=k(e,n,S);let i=a.useContext(T),c=R(e),l=e.isOpen!=null||e.defaultOpen!=null||!i?c:i,o=N(n,l.isOpen)||e.isExiting||!1;return!l.isOpen&&!o?null:f.createElement(ee,{portalContainer:r},f.createElement(ne,{...e,tooltipRef:n,isExiting:o}))});function ne(t){let r=a.useContext(T),e=a.useRef(null),[n,i]=a.useState(0);B(()=>{e.current&&r.isOpen&&i(e.current.getBoundingClientRect().width)},[r.isOpen,e]);let{overlayProps:c,arrowProps:l,placement:o}=U({placement:t.placement||"top",targetRef:t.triggerRef,overlayRef:t.tooltipRef,offset:t.offset,crossOffset:t.crossOffset,isOpen:r.isOpen,arrowSize:n,arrowBoundaryOffset:t.arrowBoundaryOffset,shouldFlip:t.shouldFlip,onClose:()=>r.close(!0)}),s=_(t.tooltipRef,!!o)||t.isEntering||!1,d=F({...t,defaultClassName:"react-aria-Tooltip",values:{placement:o,isEntering:s,isExiting:t.isExiting,state:r}});t=O(t,c);let{tooltipProps:m}=te(t,r);return f.createElement("div",{...m,ref:t.tooltipRef,...d,style:{...c.style,...d.style},"data-placement":o??void 0,"data-entering":s||void 0,"data-exiting":t.isExiting||void 0},f.createElement(j.Provider,{value:{...l,placement:o,ref:e}},d.children))}export{T as $,pe as a,$e as b};
