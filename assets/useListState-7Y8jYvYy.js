import{r as c}from"./index-CcKhGcwW.js";import{a as x,b as M,c as m}from"./Collection-Bn5P0R-H.js";function C(i){const l=c.version.split(".");return parseInt(l[0],10)>=19?i:i?"true":void 0}class ${*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(l){let e=this.keyMap.get(l);var t;return e&&(t=e.prevKey)!==null&&t!==void 0?t:null}getKeyAfter(l){let e=this.keyMap.get(l);var t;return e&&(t=e.nextKey)!==null&&t!==void 0?t:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(l){var e;return(e=this.keyMap.get(l))!==null&&e!==void 0?e:null}at(l){const e=[...this.getKeys()];return this.getItem(e[l])}getChildren(l){let e=this.keyMap.get(l);return(e==null?void 0:e.childNodes)||[]}constructor(l){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=l;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let o of n.childNodes)e(o)};for(let n of l)e(n);let t=null,y=0;for(let[n,o]of this.keyMap)t?(t.nextKey=n,o.prevKey=t.key):(this.firstKey=n,o.prevKey=void 0),o.type==="item"&&(o.index=y++),t=o,t.nextKey=void 0;var u;this.lastKey=(u=t==null?void 0:t.key)!==null&&u!==void 0?u:null}}function D(i){let{filter:l,layoutDelegate:e}=i,t=x(i),y=c.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),u=c.useCallback(K=>l?new $(l(K)):new $(K),[l]),n=c.useMemo(()=>({suppressTextValueWarning:i.suppressTextValueWarning}),[i.suppressTextValueWarning]),o=M(i,u,n),v=c.useMemo(()=>new m(o,t,{layoutDelegate:e}),[o,t,e]);return k(o,v),{collection:o,disabledKeys:y,selectionManager:v}}function T(i,l){let e=c.useMemo(()=>l?i.collection.UNSTABLE_filter(l):i.collection,[i.collection,l]),t=i.selectionManager.withCollection(e);return k(e,t),{collection:e,selectionManager:t,disabledKeys:i.disabledKeys}}function k(i,l){const e=c.useRef(null);c.useEffect(()=>{if(l.focusedKey!=null&&!i.getItem(l.focusedKey)&&e.current){const s=e.current.getItem(l.focusedKey),b=[...e.current.getKeys()].map(f=>{const d=e.current.getItem(f);return(d==null?void 0:d.type)==="item"?d:null}).filter(f=>f!==null),r=[...i.getKeys()].map(f=>{const d=i.getItem(f);return(d==null?void 0:d.type)==="item"?d:null}).filter(f=>f!==null);var t,y;const p=((t=b==null?void 0:b.length)!==null&&t!==void 0?t:0)-((y=r==null?void 0:r.length)!==null&&y!==void 0?y:0);var u,n,o;let a=Math.min(p>1?Math.max(((u=s==null?void 0:s.index)!==null&&u!==void 0?u:0)-p+1,0):(n=s==null?void 0:s.index)!==null&&n!==void 0?n:0,((o=r==null?void 0:r.length)!==null&&o!==void 0?o:0)-1),h=null,g=!1;for(;a>=0;){if(!l.isDisabled(r[a].key)){h=r[a];break}if(a<r.length-1&&!g)a++;else{g=!0;var v,K;a>((v=s==null?void 0:s.index)!==null&&v!==void 0?v:0)&&(a=(K=s==null?void 0:s.index)!==null&&K!==void 0?K:0),a--}}l.setFocusedKey(h?h.key:null)}e.current=i},[i,l])}export{D as $,C as a,T as b,$ as c};
