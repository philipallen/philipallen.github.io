import{r as y}from"./index-CcKhGcwW.js";import{a as m,b as M,c as x}from"./Collection-C9XxNqm0.js";import{$ as S}from"./useControlledState-Bw1hdnkP.js";function T(t){const l=y.version.split(".");return parseInt(l[0],10)>=19?t:t?"true":void 0}class p{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(l){let e=this.keyMap.get(l);var n;return e&&(n=e.prevKey)!==null&&n!==void 0?n:null}getKeyAfter(l){let e=this.keyMap.get(l);var n;return e&&(n=e.nextKey)!==null&&n!==void 0?n:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(l){var e;return(e=this.keyMap.get(l))!==null&&e!==void 0?e:null}at(l){const e=[...this.getKeys()];return this.getItem(e[l])}getChildren(l){let e=this.keyMap.get(l);return(e==null?void 0:e.childNodes)||[]}constructor(l){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=l;let e=i=>{if(this.keyMap.set(i.key,i),i.childNodes&&i.type==="section")for(let o of i.childNodes)e(o)};for(let i of l)e(i);let n=null,a=0;for(let[i,o]of this.keyMap)n?(n.nextKey=i,o.prevKey=n.key):(this.firstKey=i,o.prevKey=void 0),o.type==="item"&&(o.index=a++),n=o,n.nextKey=void 0;var d;this.lastKey=(d=n==null?void 0:n.key)!==null&&d!==void 0?d:null}}function w(t){let{filter:l,layoutDelegate:e}=t,n=m(t),a=y.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),d=y.useCallback(u=>l?new p(l(u)):new p(u),[l]),i=y.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),o=M(t,d,i),f=y.useMemo(()=>new x(o,n,{layoutDelegate:e}),[o,n,e]);return k(o,f),{collection:o,disabledKeys:a,selectionManager:f}}function F(t,l){let e=y.useMemo(()=>l?t.collection.UNSTABLE_filter(l):t.collection,[t.collection,l]),n=t.selectionManager.withCollection(e);return k(e,n),{collection:e,selectionManager:n,disabledKeys:t.disabledKeys}}function k(t,l){const e=y.useRef(null);y.useEffect(()=>{if(l.focusedKey!=null&&!t.getItem(l.focusedKey)&&e.current){const s=e.current.getItem(l.focusedKey),K=[...e.current.getKeys()].map(b=>{const c=e.current.getItem(b);return(c==null?void 0:c.type)==="item"?c:null}).filter(b=>b!==null),r=[...t.getKeys()].map(b=>{const c=t.getItem(b);return(c==null?void 0:c.type)==="item"?c:null}).filter(b=>b!==null);var n,a;const h=((n=K==null?void 0:K.length)!==null&&n!==void 0?n:0)-((a=r==null?void 0:r.length)!==null&&a!==void 0?a:0);var d,i,o;let v=Math.min(h>1?Math.max(((d=s==null?void 0:s.index)!==null&&d!==void 0?d:0)-h+1,0):(i=s==null?void 0:s.index)!==null&&i!==void 0?i:0,((o=r==null?void 0:r.length)!==null&&o!==void 0?o:0)-1),g=null,$=!1;for(;v>=0;){if(!l.isDisabled(r[v].key)){g=r[v];break}if(v<r.length-1&&!$)v++;else{$=!0;var f,u;v>((f=s==null?void 0:s.index)!==null&&f!==void 0?f:0)&&(v=(u=s==null?void 0:s.index)!==null&&u!==void 0?u:0),v--}}l.setFocusedKey(g?g.key:null)}e.current=t},[t,l])}function N(t){var l;let[e,n]=S(t.selectedKey,(l=t.defaultSelectedKey)!==null&&l!==void 0?l:null,t.onSelectionChange),a=y.useMemo(()=>e!=null?[e]:[],[e]),{collection:d,disabledKeys:i,selectionManager:o}=w({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:a,onSelectionChange:u=>{if(u==="all")return;var s;let K=(s=u.values().next().value)!==null&&s!==void 0?s:null;K===e&&t.onSelectionChange&&t.onSelectionChange(K),n(K)}}),f=e!=null?d.getItem(e):null;return{collection:d,disabledKeys:i,selectionManager:o,selectedKey:e,setSelectedKey:n,selectedItem:f}}export{T as $,w as a,F as b,N as c,p as d};
