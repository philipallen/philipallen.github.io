import{a as h}from"./Button-rO-PiLt4.js";import{l as p,m as F,j as M,b as $,a as A,i as g,n as V,f as W,c as I}from"./utils-HuDI8Qn7.js";import{$ as x}from"./filterDOMProps-CeZl_uWj.js";import{r as n,e as c}from"./index-KmaxkdDD.js";import{$ as P}from"./useControlledState-TGcPotj3.js";import{r as k}from"./index-Ccpfuzew.js";import{$ as N}from"./useEvent-BQn9_lKw.js";import{a as D}from"./useFocusRing-sAzOUMLq.js";function B(l,e,d){let{isDisabled:a}=l,t=p(),s=p(),o=!F()&&"onbeforematch"in document.body,i=n.useRef(null),u=n.useCallback(()=>{i.current=requestAnimationFrame(()=>{d.current&&d.current.setAttribute("hidden","until-found")}),k.flushSync(()=>{e.toggle()})},[d,e]);return N(d,"beforematch",o?u:null),M(()=>{i.current&&cancelAnimationFrame(i.current),o&&d.current&&!a&&(e.isExpanded?d.current.removeAttribute("hidden"):d.current.setAttribute("hidden","until-found"))},[a,d,e.isExpanded,o]),n.useEffect(()=>()=>{i.current&&cancelAnimationFrame(i.current)},[]),{buttonProps:{id:t,"aria-expanded":e.isExpanded,"aria-controls":s,onPress:f=>{!a&&f.pointerType!=="keyboard"&&e.toggle()},isDisabled:a,onPressStart(f){f.pointerType==="keyboard"&&!a&&e.toggle()}},panelProps:{id:s,role:"group","aria-labelledby":t,"aria-hidden":!e.isExpanded,hidden:o?!0:!e.isExpanded}}}function G(l){let[e,d]=P(l.isExpanded,l.defaultExpanded||!1,l.onExpandedChange);const a=n.useCallback(()=>{d(!0)},[d]),t=n.useCallback(()=>{d(!1)},[d]),s=n.useCallback(()=>{d(!e)},[d,e]);return{isExpanded:e,setExpanded:d,expand:a,collapse:t,toggle:s}}function T(l){let{allowsMultipleExpanded:e=!1,isDisabled:d=!1}=l,[a,t]=P(n.useMemo(()=>l.expandedKeys?new Set(l.expandedKeys):void 0,[l.expandedKeys]),n.useMemo(()=>l.defaultExpandedKeys?new Set(l.defaultExpandedKeys):new Set,[l.defaultExpandedKeys]),l.onExpandedChange);return n.useEffect(()=>{!e&&a.size>1&&t(new Set([a.values().next().value]))}),{allowsMultipleExpanded:e,isDisabled:d,expandedKeys:a,setExpandedKeys:t,toggleKey(s){let r;e?(r=new Set(a),r.has(s)?r.delete(s):r.add(s)):r=new Set(a.has(s)?[]:[s]),t(r)}}}const v=n.createContext(null),X=n.forwardRef(function(e,d){let a=T(e),t=$({...e,defaultClassName:"react-aria-DisclosureGroup",values:{isDisabled:a.isDisabled,state:a}}),s=x(e);return c.createElement("div",{...s,...t,ref:d,"data-disabled":e.isDisabled||void 0},c.createElement(v.Provider,{value:a},t.children))}),_=n.createContext(null),j=n.createContext(null),C=n.createContext(null),Y=n.forwardRef(function(e,d){[e,d]=A(e,d,_);let a=n.useContext(v),{id:t,...s}=e,r=p();t||(t=r);let o=a?a.expandedKeys.has(t):e.isExpanded,i=G({...e,isExpanded:o,onExpandedChange(R){var b;a&&a.toggleKey(t),(b=e.onExpandedChange)===null||b===void 0||b.call(e,R)}}),u=c.useRef(null),f=e.isDisabled||(a==null?void 0:a.isDisabled)||!1,{buttonProps:y,panelProps:w}=B({...e,isExpanded:o,isDisabled:f},i,u),{isFocusVisible:m,focusProps:K}=D({within:!0}),E=$({...e,id:void 0,defaultClassName:"react-aria-Disclosure",values:{isExpanded:i.isExpanded,isDisabled:f,isFocusVisibleWithin:m,state:i}}),S=x(s);return c.createElement(g,{values:[[h,{slots:{[V]:{},trigger:y}}],[C,{panelProps:w,panelRef:u}],[j,i]]},c.createElement("div",{ref:d,"data-expanded":i.isExpanded||void 0,"data-disabled":f||void 0,"data-focus-visible-within":m||void 0,...S,...K,...E},E.children))}),Z=n.forwardRef(function(e,d){let{role:a="group"}=e,{panelProps:t,panelRef:s}=n.useContext(C),{isFocusVisible:r,focusProps:o}=D({within:!0}),i=$({...e,defaultClassName:"react-aria-DisclosurePanel",values:{isFocusVisibleWithin:r}}),u=x(e);return c.createElement("div",{...u,ref:W(d,s),...I(t,o),...i,role:a,"data-focus-visible-within":r||void 0},c.createElement(g,{values:[[h,null]]},e.children))});export{Y as $,Z as a,X as b};
