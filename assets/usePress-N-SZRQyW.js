import{w as se,p as F,q as oe,x as le,o as Q,t as fe,u as ce,c as b,i as $,y as de,e as L,z as ue,A as pe,$ as N}from"./focusSafely-B-zcuC90.js";import{e as ve,f as G,g as $e,i as ge}from"./useFocusRing-G-z0GAlQ.js";import{r as E,e as be}from"./index-CcKhGcwW.js";import{e as x,d as Z,a as ye}from"./utils-BPOuYIA2.js";import"./index-uaANFLeC.js";const Pe=E.createContext({isNative:!0,open:Ee,useHref:t=>t});function Te(){return E.useContext(Pe)}function K(t,a,i=!0){var o,f;let{metaKey:p,ctrlKey:v,altKey:u,shiftKey:T}=a;se()&&(!((f=window.event)===null||f===void 0||(o=f.type)===null||o===void 0)&&o.startsWith("key"))&&t.target==="_blank"&&(F()?p=!0:v=!0);let h=oe()&&F()&&!le()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:p,ctrlKey:v,altKey:u,shiftKey:T}):new MouseEvent("click",{metaKey:p,ctrlKey:v,altKey:u,shiftKey:T,bubbles:!0,cancelable:!0});K.isOpening=i,Q(t),t.dispatchEvent(h),K.isOpening=!1}K.isOpening=!1;function he(t,a){if(t instanceof HTMLAnchorElement)a(t);else if(t.hasAttribute("data-href")){let i=document.createElement("a");i.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(i.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(i.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(i.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(i.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(i.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(i),a(i),t.removeChild(i)}}function Ee(t,a){he(t,i=>K(i,a))}function De(t){let a=Te();var i;const o=a.useHref((i=t==null?void 0:t.href)!==null&&i!==void 0?i:"");return{href:t!=null&&t.href?o:void 0,target:t==null?void 0:t.target,rel:t==null?void 0:t.rel,download:t==null?void 0:t.download,ping:t==null?void 0:t.ping,referrerPolicy:t==null?void 0:t.referrerPolicy}}const ee=be.createContext({register:()=>{}});ee.displayName="PressResponderContext";function me(t,a){return a.get?a.get.call(t):a.value}function te(t,a,i){if(!a.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return a.get(t)}function xe(t,a){var i=te(t,a,"get");return me(t,i)}function we(t,a){if(a.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ke(t,a,i){we(t,a),a.set(t,i)}function _e(t,a,i){if(a.set)a.set.call(t,i);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=i}}function V(t,a,i){var o=te(t,a,"set");return _e(t,o,i),i}function Ke(t){let a=E.useContext(ee);if(a){let{register:i,...o}=a;t=Z(o,t),i()}return ge(a,t.ref),t}var M=new WeakMap;class O{continuePropagation(){V(this,M,!1)}get shouldStopPropagation(){return xe(this,M)}constructor(a,i,o,f){ke(this,M,{writable:!0,value:void 0}),V(this,M,!0);var p;let v=(p=f==null?void 0:f.target)!==null&&p!==void 0?p:o.currentTarget;const u=v==null?void 0:v.getBoundingClientRect();let T,h=0,S,y=null;o.clientX!=null&&o.clientY!=null&&(S=o.clientX,y=o.clientY),u&&(S!=null&&y!=null?(T=S-u.left,h=y-u.top):(T=u.width/2,h=u.height/2)),this.type=a,this.pointerType=i,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=T,this.y=h}}const W=Symbol("linkClicked"),q="react-aria-pressable-style",j="data-react-aria-pressable";function He(t){let{onPress:a,onPressChange:i,onPressStart:o,onPressEnd:f,onPressUp:p,onClick:v,isDisabled:u,isPressed:T,preventFocusOnPress:h,shouldCancelOnPointerExit:S,allowTextSelectionOnPress:y,ref:D,...ne}=Ke(t),[ae,B]=E.useState(!1),w=E.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:C,removeAllGlobalListeners:H}=ve(),A=x((e,s)=>{let c=w.current;if(u||c.didFirePressStart)return!1;let r=!0;if(c.isTriggeringEvent=!0,o){let l=new O("pressstart",s,e);o(l),r=l.shouldStopPropagation}return i&&i(!0),c.isTriggeringEvent=!1,c.didFirePressStart=!0,B(!0),r}),k=x((e,s,c=!0)=>{let r=w.current;if(!r.didFirePressStart)return!1;r.didFirePressStart=!1,r.isTriggeringEvent=!0;let l=!0;if(f){let n=new O("pressend",s,e);f(n),l=n.shouldStopPropagation}if(i&&i(!1),B(!1),a&&c&&!u){let n=new O("press",s,e);a(n),l&&(l=n.shouldStopPropagation)}return r.isTriggeringEvent=!1,l}),I=x((e,s)=>{let c=w.current;if(u)return!1;if(p){c.isTriggeringEvent=!0;let r=new O("pressup",s,e);return p(r),c.isTriggeringEvent=!1,r.shouldStopPropagation}return!0}),m=x(e=>{let s=w.current;if(s.isPressed&&s.target){s.didFirePressStart&&s.pointerType!=null&&k(_(s.target,e),s.pointerType,!1),s.isPressed=!1,s.isOverTarget=!1,s.activePointerId=null,s.pointerType=null,H(),y||G(s.target);for(let c of s.disposables)c();s.disposables=[]}}),X=x(e=>{S&&m(e)}),U=x(e=>{v==null||v(e)}),z=x((e,s)=>{if(v){let c=new MouseEvent("click",e);fe(c,s),v(ce(c))}}),ie=E.useMemo(()=>{let e=w.current,s={onKeyDown(r){if(R(r.nativeEvent,r.currentTarget)&&b(r.currentTarget,$(r.nativeEvent))){var l;J($(r.nativeEvent),r.key)&&r.preventDefault();let n=!0;if(!e.isPressed&&!r.repeat){e.target=r.currentTarget,e.isPressed=!0,e.pointerType="keyboard",n=A(r,"keyboard");let d=r.currentTarget,g=P=>{R(P,d)&&!P.repeat&&b(d,$(P))&&e.target&&I(_(e.target,P),"keyboard")};C(L(r.currentTarget),"keyup",ye(g,c),!0)}n&&r.stopPropagation(),r.metaKey&&F()&&((l=e.metaKeyEvents)===null||l===void 0||l.set(r.key,r.nativeEvent))}else r.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(r){if(!(r&&!b(r.currentTarget,$(r.nativeEvent)))&&r&&r.button===0&&!e.isTriggeringEvent&&!K.isOpening){let l=!0;if(u&&r.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||pe(r.nativeEvent))){let n=A(r,"virtual"),d=I(r,"virtual"),g=k(r,"virtual");U(r),l=n&&d&&g}else if(e.isPressed&&e.pointerType!=="keyboard"){let n=e.pointerType||r.nativeEvent.pointerType||"virtual";l=k(_(r.currentTarget,r),n,!0),e.isOverTarget=!1,U(r),m(r)}e.ignoreEmulatedMouseEvents=!1,l&&r.stopPropagation()}}},c=r=>{var l;if(e.isPressed&&e.target&&R(r,e.target)){var n;J($(r),r.key)&&r.preventDefault();let g=$(r),P=b(e.target,$(r));k(_(e.target,r),"keyboard",P),P&&z(r,e.target),H(),r.key!=="Enter"&&Y(e.target)&&b(e.target,g)&&!r[W]&&(r[W]=!0,K(e.target,r,!1)),e.isPressed=!1,(n=e.metaKeyEvents)===null||n===void 0||n.delete(r.key)}else if(r.key==="Meta"&&(!((l=e.metaKeyEvents)===null||l===void 0)&&l.size)){var d;let g=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let P of g.values())(d=e.target)===null||d===void 0||d.dispatchEvent(new KeyboardEvent("keyup",P))}};if(typeof PointerEvent<"u"){s.onPointerDown=n=>{if(n.button!==0||!b(n.currentTarget,$(n.nativeEvent)))return;if(de(n.nativeEvent)){e.pointerType="virtual";return}e.pointerType=n.pointerType;let d=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,y||$e(e.target),d=A(n,e.pointerType);let g=$(n.nativeEvent);"releasePointerCapture"in g&&g.releasePointerCapture(n.pointerId),C(L(n.currentTarget),"pointerup",r,!1),C(L(n.currentTarget),"pointercancel",l,!1)}d&&n.stopPropagation()},s.onMouseDown=n=>{if(b(n.currentTarget,$(n.nativeEvent))&&n.button===0){if(h){let d=ue(n.target);d&&e.disposables.push(d)}n.stopPropagation()}},s.onPointerUp=n=>{!b(n.currentTarget,$(n.nativeEvent))||e.pointerType==="virtual"||n.button===0&&I(n,e.pointerType||n.pointerType)},s.onPointerEnter=n=>{n.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,A(_(e.target,n),e.pointerType))},s.onPointerLeave=n=>{n.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,k(_(e.target,n),e.pointerType,!1),X(n))};let r=n=>{if(n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target){if(b(e.target,$(n))&&e.pointerType!=null){let d=!1,g=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(d?m(n):(Q(e.target),e.target.click()))},80);C(n.currentTarget,"click",()=>d=!0,!0),e.disposables.push(()=>clearTimeout(g))}else m(n);e.isOverTarget=!1}},l=n=>{m(n)};s.onDragStart=n=>{b(n.currentTarget,$(n.nativeEvent))&&m(n)}}return s},[C,u,h,H,y,m,X,k,A,I,U,z]);return E.useEffect(()=>{if(!D)return;const e=L(D.current);if(!e||!e.head||e.getElementById(q))return;const s=e.createElement("style");s.id=q,s.textContent=`
@layer {
  [${j}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(s)},[D]),E.useEffect(()=>{let e=w.current;return()=>{var s;y||G((s=e.target)!==null&&s!==void 0?s:void 0);for(let c of e.disposables)c();e.disposables=[]}},[y]),{isPressed:T||ae,pressProps:Z(ne,ie,{[j]:!0})}}function Y(t){return t.tagName==="A"&&t.hasAttribute("href")}function R(t,a){const{key:i,code:o}=t,f=a,p=f.getAttribute("role");return(i==="Enter"||i===" "||i==="Spacebar"||o==="Space")&&!(f instanceof N(f).HTMLInputElement&&!re(f,i)||f instanceof N(f).HTMLTextAreaElement||f.isContentEditable)&&!((p==="link"||!p&&Y(f))&&i!=="Enter")}function _(t,a){let i=a.clientX,o=a.clientY;return{currentTarget:t,shiftKey:a.shiftKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey,altKey:a.altKey,clientX:i,clientY:o}}function Se(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!Y(t)}function J(t,a){return t instanceof HTMLInputElement?!re(t,a):Se(t)}const Ce=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function re(t,a){return t.type==="checkbox"||t.type==="radio"?a===" ":Ce.has(t.type)}export{He as $,ke as _,De as a,Te as b,K as c,ee as d};
