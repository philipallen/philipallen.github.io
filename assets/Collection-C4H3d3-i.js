import{n as Fe}from"./useFocusRing-8RL9AhDF.js";import{r as xe}from"./index-D9uilScg.js";import{r as d,R as K}from"./index-DH5ua8nC.js";import{d as Ce,$ as oe,b as de,c as Te}from"./useFocusWithin-D15f1-3B.js";import{$ as le}from"./chain-Crd5RmWG.js";import{s as Ae}from"./index-CzvSJj6w.js";import{l as Ie,c as ie,f as fe,k as he}from"./focusSafely-CjmyL4wt.js";import{$ as we,c as ke,d as Re}from"./usePress-BnN3djkX.js";import{$ as H}from"./useEvent-Ck1tIt86.js";import{$ as Be,a as ze,b as ye}from"./scrollIntoView-Bir1BNbC.js";import{a as Le}from"./FocusScope-92UDUlTt.js";import{$ as Ve}from"./context-ERQbR2fL.js";import{c as Oe,g as Ne}from"./platform-Dbfj6p2q.js";import{$ as Ue}from"./useControlledState-BSXamw7l.js";function pe(n,e){const t=d.useRef(!0),l=d.useRef(null);le(()=>(t.current=!0,()=>{t.current=!1}),[]),le(()=>{t.current?t.current=!1:(!l.current||e.some((i,s)=>!Object.is(i,l[s])))&&n(),l.current=e},e)}const qe="react-aria-clear-focus",We="react-aria-focus",De="react-aria-update-activedescendant";function U(n){return Oe()?n.metaKey:n.ctrlKey}class re{get childNodes(){throw new Error("childNodes is not supported")}clone(){let e=new re(this.type,this.key);return e.value=this.value,e.level=this.level,e.hasChildNodes=this.hasChildNodes,e.rendered=this.rendered,e.textValue=this.textValue,e["aria-label"]=this["aria-label"],e.index=this.index,e.parentKey=this.parentKey,e.prevKey=this.prevKey,e.nextKey=this.nextKey,e.firstChildKey=this.firstChildKey,e.lastChildKey=this.lastChildKey,e.props=this.props,e.render=this.render,e}constructor(e,t){this.value=null,this.level=0,this.hasChildNodes=!1,this.rendered=null,this.textValue="",this["aria-label"]=void 0,this.index=0,this.parentKey=null,this.prevKey=null,this.nextKey=null,this.firstChildKey=null,this.lastChildKey=null,this.props={},this.type=e,this.key=t}}class ue{get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}*[Symbol.iterator](){let e=this.firstKey!=null?this.keyMap.get(this.firstKey):void 0;for(;e;)yield e,e=e.nextKey!=null?this.keyMap.get(e.nextKey):void 0}getChildren(e){let t=this.keyMap;return{*[Symbol.iterator](){let l=t.get(e),i=(l==null?void 0:l.firstChildKey)!=null?t.get(l.firstChildKey):null;for(;i;)yield i,i=i.nextKey!=null?t.get(i.nextKey):void 0}}}getKeyBefore(e){let t=this.keyMap.get(e);if(!t)return null;if(t.prevKey!=null){for(t=this.keyMap.get(t.prevKey);t&&t.type!=="item"&&t.lastChildKey!=null;)t=this.keyMap.get(t.lastChildKey);var l;return(l=t==null?void 0:t.key)!==null&&l!==void 0?l:null}return t.parentKey}getKeyAfter(e){let t=this.keyMap.get(e);if(!t)return null;if(t.type!=="item"&&t.firstChildKey!=null)return t.firstChildKey;for(;t;){if(t.nextKey!=null)return t.nextKey;if(t.parentKey!=null)t=this.keyMap.get(t.parentKey);else return null}return null}getFirstKey(){return this.firstKey}getLastKey(){let e=this.lastKey!=null?this.keyMap.get(this.lastKey):null;for(;(e==null?void 0:e.lastChildKey)!=null;)e=this.keyMap.get(e.lastChildKey);var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(){throw new Error("Not implemented")}clone(){let e=this.constructor,t=new e;return t.keyMap=new Map(this.keyMap),t.firstKey=this.firstKey,t.lastKey=this.lastKey,t}addNode(e){if(this.frozen)throw new Error("Cannot add a node to a frozen collection");this.keyMap.set(e.key,e)}removeNode(e){if(this.frozen)throw new Error("Cannot remove a node to a frozen collection");this.keyMap.delete(e)}commit(e,t,l=!1){if(this.frozen)throw new Error("Cannot commit a frozen collection");this.firstKey=e,this.lastKey=t,this.frozen=!l}filter(e){let t=new ue,l=null;for(let i of this)if(i.type==="section"&&i.hasChildNodes){let s=i.clone(),o=null;for(let c of this.getChildren(i.key))if(e(c.textValue)||c.type==="header"){let u=c.clone();o==null&&(s.firstChildKey=u.key),t.firstKey==null&&(t.firstKey=s.key),o&&o.parentKey===u.parentKey?(o.nextKey=u.key,u.prevKey=o.key):u.prevKey=null,u.nextKey=null,t.addNode(u),o=u}o&&(o.type!=="header"?(s.lastChildKey=o.key,l==null?s.prevKey=null:(l.type==="section"||l.type==="separator")&&(l.nextKey=s.key,s.prevKey=l.key),s.nextKey=null,l=s,t.addNode(s)):(t.firstKey===s.key&&(t.firstKey=null),t.removeNode(o.key)))}else if(i.type==="separator"){let s=i.clone();s.nextKey=null,(l==null?void 0:l.type)==="section"&&(l.nextKey=s.key,s.prevKey=l.key,l=s,t.addNode(s))}else if(e(i.textValue)){let s=i.clone();t.firstKey==null&&(t.firstKey=s.key),l!=null&&l.type!=="section"&&l.type!=="separator"&&l.parentKey===s.parentKey?(l.nextKey=s.key,s.prevKey=l.key):s.prevKey=null,s.nextKey=null,t.addNode(s),l=s}if((l==null?void 0:l.type)==="separator"&&l.nextKey===null){let i;l.prevKey!=null&&(i=t.getItem(l.prevKey),i.nextKey=null),t.removeNode(l.key),l=i}return t.lastKey=(l==null?void 0:l.key)||null,t}constructor(){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.frozen=!1}}class Pe{*[Symbol.iterator](){let e=this.firstChild;for(;e;)yield e,e=e.nextSibling}get firstChild(){return this._firstChild}set firstChild(e){this._firstChild=e,this.ownerDocument.markDirty(this)}get lastChild(){return this._lastChild}set lastChild(e){this._lastChild=e,this.ownerDocument.markDirty(this)}get previousSibling(){return this._previousSibling}set previousSibling(e){this._previousSibling=e,this.ownerDocument.markDirty(this)}get nextSibling(){return this._nextSibling}set nextSibling(e){this._nextSibling=e,this.ownerDocument.markDirty(this)}get parentNode(){return this._parentNode}set parentNode(e){this._parentNode=e,this.ownerDocument.markDirty(this)}get isConnected(){var e;return((e=this.parentNode)===null||e===void 0?void 0:e.isConnected)||!1}appendChild(e){this.ownerDocument.startTransaction(),e.parentNode&&e.parentNode.removeChild(e),this.firstChild==null&&(this.firstChild=e),this.lastChild?(this.lastChild.nextSibling=e,e.index=this.lastChild.index+1,e.previousSibling=this.lastChild):(e.previousSibling=null,e.index=0),e.parentNode=this,e.nextSibling=null,this.lastChild=e,this.ownerDocument.markDirty(this),e.hasSetProps&&this.ownerDocument.addNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}insertBefore(e,t){if(t==null)return this.appendChild(e);this.ownerDocument.startTransaction(),e.parentNode&&e.parentNode.removeChild(e),e.nextSibling=t,e.previousSibling=t.previousSibling,e.index=t.index,this.firstChild===t?this.firstChild=e:t.previousSibling&&(t.previousSibling.nextSibling=e),t.previousSibling=e,e.parentNode=t.parentNode;let l=t;for(;l;)l.index++,l=l.nextSibling;e.hasSetProps&&this.ownerDocument.addNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}removeChild(e){if(e.parentNode!==this||!this.ownerDocument.isMounted)return;this.ownerDocument.startTransaction();let t=e.nextSibling;for(;t;)t.index--,t=t.nextSibling;e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling),e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling),this.firstChild===e&&(this.firstChild=e.nextSibling),this.lastChild===e&&(this.lastChild=e.previousSibling),e.parentNode=null,e.nextSibling=null,e.previousSibling=null,e.index=0,this.ownerDocument.removeNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}addEventListener(){}removeEventListener(){}constructor(e){this._firstChild=null,this._lastChild=null,this._previousSibling=null,this._nextSibling=null,this._parentNode=null,this.ownerDocument=e}}class W extends Pe{get index(){return this._index}set index(e){this._index=e,this.ownerDocument.markDirty(this)}get level(){return this.parentNode instanceof W?this.parentNode.level+(this.node.type==="item"?1:0):0}updateNode(){var e,t,l,i;let s=this.ownerDocument.getMutableNode(this);s.index=this.index,s.level=this.level,s.parentKey=this.parentNode instanceof W?this.parentNode.node.key:null;var o;s.prevKey=(o=(e=this.previousSibling)===null||e===void 0?void 0:e.node.key)!==null&&o!==void 0?o:null;var c;s.nextKey=(c=(t=this.nextSibling)===null||t===void 0?void 0:t.node.key)!==null&&c!==void 0?c:null,s.hasChildNodes=!!this.firstChild;var u;s.firstChildKey=(u=(l=this.firstChild)===null||l===void 0?void 0:l.node.key)!==null&&u!==void 0?u:null;var m;s.lastChildKey=(m=(i=this.lastChild)===null||i===void 0?void 0:i.node.key)!==null&&m!==void 0?m:null}setProps(e,t,l,i){let s=this.ownerDocument.getMutableNode(this),{value:o,textValue:c,id:u,...m}=e;if(m.ref=t,s.props=m,s.rendered=l,s.render=i,s.value=o,s.textValue=c||(typeof m.children=="string"?m.children:"")||e["aria-label"]||"",u!=null&&u!==s.key){if(this.hasSetProps)throw new Error("Cannot change the id of an item");s.key=u}this.hasSetProps||(this.ownerDocument.addNode(this),this.ownerDocument.endTransaction(),this.hasSetProps=!0),this.ownerDocument.queueUpdate()}get style(){return{}}hasAttribute(){}setAttribute(){}setAttributeNS(){}removeAttribute(){}constructor(e,t){super(t),this.nodeType=8,this._index=0,this.hasSetProps=!1,this.node=new re(e,`react-aria-${++t.nodeId}`),this.ownerDocument.startTransaction()}}class Ge extends Pe{get isConnected(){return this.isMounted}createElement(e){return new W(e,this)}getMutableNode(e){let t=e.node;return this.mutatedNodes.has(e)||(t=e.node.clone(),this.mutatedNodes.add(e),e.node=t),this.markDirty(e),t}getMutableCollection(){return!this.isSSR&&!this.collectionMutated&&(this.collection=this.collection.clone(),this.collectionMutated=!0),this.collection}markDirty(e){this.dirtyNodes.add(e)}startTransaction(){this.transactionCount++}endTransaction(){this.transactionCount--}addNode(e){let t=this.getMutableCollection();if(!t.getItem(e.node.key)){t.addNode(e.node);for(let l of e)this.addNode(l)}this.markDirty(e)}removeNode(e){for(let l of e)this.removeNode(l);this.getMutableCollection().removeNode(e.node.key),this.markDirty(e)}getCollection(){return this.transactionCount>0?this.collection:(this.updateCollection(),this.collection)}updateCollection(){for(let s of this.dirtyNodes)s instanceof W&&s.isConnected&&s.updateNode();if(this.dirtyNodes.clear(),this.mutatedNodes.size||this.collectionMutated){var e,t;let s=this.getMutableCollection();for(let o of this.mutatedNodes)o.isConnected&&s.addNode(o.node);var l,i;s.commit((l=(e=this.firstChild)===null||e===void 0?void 0:e.node.key)!==null&&l!==void 0?l:null,(i=(t=this.lastChild)===null||t===void 0?void 0:t.node.key)!==null&&i!==void 0?i:null,this.isSSR),this.mutatedNodes.clear()}this.collectionMutated=!1}queueUpdate(){if(!(this.dirtyNodes.size===0||this.transactionCount>0))for(let e of this.subscriptions)e()}subscribe(e){return this.subscriptions.add(e),()=>this.subscriptions.delete(e)}resetAfterSSR(){this.isSSR&&(this.isSSR=!1,this.firstChild=null,this.lastChild=null,this.nodeId=0)}constructor(e){super(null),this.nodeType=11,this.ownerDocument=this,this.dirtyNodes=new Set,this.isSSR=!1,this.nodeId=0,this.nodesByProps=new WeakMap,this.isMounted=!0,this.mutatedNodes=new Set,this.subscriptions=new Set,this.transactionCount=0,this.collection=e,this.collectionMutated=!0}}function Ee(n){let{children:e,items:t,idScope:l,addIdAndValue:i,dependencies:s=[]}=n,o=d.useMemo(()=>new WeakMap,s);return d.useMemo(()=>{if(t&&typeof e=="function"){let m=[];for(let x of t){let g=o.get(x);if(!g){g=e(x);var c,u;let y=(u=(c=g.props.id)!==null&&c!==void 0?c:x.key)!==null&&u!==void 0?u:x.id;if(y==null)throw new Error("Could not determine key for item");l&&(y=l+":"+y),g=d.cloneElement(g,i?{key:y,id:y,value:x}:{key:y}),o.set(x,g)}m.push(g)}return m}else if(typeof e!="function")return e},[e,t,o,l,i])}const Me=d.createContext(!1),G=d.createContext(null);function wt(n){if(d.useContext(G))return n.content;let{collection:t,document:l}=Ze(n.createCollection);return K.createElement(K.Fragment,null,K.createElement(Fe,null,K.createElement(G.Provider,{value:l},n.content)),K.createElement(He,{render:n.children,collection:t}))}function He({collection:n,render:e}){return e(n)}function je(n,e,t){let l=Ce(),i=d.useRef(l);i.current=l;let s=d.useCallback(()=>i.current?t():e(),[e,t]);return Ae.useSyncExternalStore(n,s)}const Ye=typeof K.useSyncExternalStore=="function"?K.useSyncExternalStore:je;function Ze(n){let[e]=d.useState(()=>new Ge((n==null?void 0:n())||new ue)),t=d.useCallback(o=>e.subscribe(o),[e]),l=d.useCallback(()=>{let o=e.getCollection();return e.isSSR&&e.resetAfterSSR(),o},[e]),i=d.useCallback(()=>(e.isSSR=!0,e.getCollection()),[e]),s=Ye(t,l,i);return le(()=>(e.isMounted=!0,()=>{e.isMounted=!1}),[e]),{collection:s,document:e}}const ne=d.createContext(null);function Je(n,e,t,l,i,s){let o=d.useCallback(u=>{u==null||u.setProps(e,t,l,s)},[e,t,l,s]),c=d.useContext(ne);if(c){let u=c.ownerDocument.nodesByProps.get(e);return u||(u=c.ownerDocument.createElement(n),u.setProps(e,t,l,s),c.appendChild(u),c.ownerDocument.updateCollection(),c.ownerDocument.nodesByProps.set(e,u)),i?K.createElement(ne.Provider,{value:u},i):null}return K.createElement(n,{ref:o},i)}function kt(n,e){let t=({node:i})=>e(i.props,i.props.ref,i),l=d.forwardRef((i,s)=>{if(!d.useContext(Me)){if(e.length>=3)throw new Error(e.name+" cannot be rendered outside a collection.");return e(i,s)}return Je(n,i,s,"children"in i?i.children:null,null,c=>K.createElement(t,{node:c}))});return l.displayName=e.name,l}function Qe(n){return Ee({...n,addIdAndValue:!0})}const ve=d.createContext(null);function Dt(n){let e=d.useContext(ve),t=((e==null?void 0:e.dependencies)||[]).concat(n.dependencies),l=n.idScope||(e==null?void 0:e.idScope),i=Qe({...n,idScope:l,dependencies:t});return d.useContext(G)&&(i=K.createElement(Xe,null,i)),e=d.useMemo(()=>({dependencies:t,idScope:l}),[l,...t]),K.createElement(ve.Provider,{value:e},i)}function Xe({children:n}){let e=d.useContext(G),t=d.useMemo(()=>K.createElement(G.Provider,{value:null},K.createElement(Me.Provider,{value:!0},n)),[n]);return Ce()?K.createElement(ne.Provider,{value:e},t):xe.createPortal(t,e)}const _e=500;function et(n){let{isDisabled:e,onLongPressStart:t,onLongPressEnd:l,onLongPress:i,threshold:s=_e,accessibilityDescription:o}=n;const c=d.useRef(void 0);let{addGlobalListener:u,removeGlobalListener:m}=Ie(),{pressProps:x}=we({isDisabled:e,onPressStart(y){if(y.continuePropagation(),(y.pointerType==="mouse"||y.pointerType==="touch")&&(t&&t({...y,type:"longpressstart"}),c.current=setTimeout(()=>{y.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),i&&i({...y,type:"longpress"}),c.current=void 0},s),y.pointerType==="touch")){let h=E=>{E.preventDefault()};u(y.target,"contextmenu",h,{once:!0}),u(window,"pointerup",()=>{setTimeout(()=>{m(y.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(y){c.current&&clearTimeout(c.current),l&&(y.pointerType==="mouse"||y.pointerType==="touch")&&l({...y,type:"longpressend"})}}),g=Be(i&&!e?o:void 0);return{longPressProps:oe(x,g)}}function se(n){return Ne()?n.altKey:n.ctrlKey}const tt=1e3;function lt(n){let{keyboardDelegate:e,selectionManager:t,onTypeSelect:l}=n,i=d.useRef({search:"",timeout:void 0}).current,s=o=>{let c=it(o.key);if(!(!c||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target))){if(c===" "&&i.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),i.search+=c,e.getKeyForSearch!=null){let u=e.getKeyForSearch(i.search,t.focusedKey);u==null&&(u=e.getKeyForSearch(i.search)),u!=null&&(t.setFocusedKey(u),l&&l(u))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},tt)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?s:void 0}}}function it(n){return n.length===1||!/^[A-Z]/i.test(n)?n:""}function Pt(n){let{selectionManager:e,keyboardDelegate:t,ref:l,autoFocus:i=!1,shouldFocusWrap:s=!1,disallowEmptySelection:o=!1,disallowSelectAll:c=!1,selectOnFocus:u=e.selectionBehavior==="replace",disallowTypeAhead:m=!1,shouldUseVirtualFocus:x,allowsTabNavigation:g=!1,isVirtualized:y,scrollRef:h=l,linkBehavior:E="action"}=n,{direction:T}=Ve(),S=ke(),v=a=>{var p;if(a.altKey&&a.key==="Tab"&&a.preventDefault(),!(!((p=l.current)===null||p===void 0)&&p.contains(a.target)))return;const $=(f,O)=>{if(f!=null){if(e.isLink(f)&&E==="selection"&&u&&!se(a)){var V;xe.flushSync(()=>{e.setFocusedKey(f,O)});let ae=(V=h.current)===null||V===void 0?void 0:V.querySelector(`[data-key="${CSS.escape(f.toString())}"]`),ce=e.getItemProps(f);ae&&S.open(ae,a,ce.href,ce.routerOptions);return}if(e.setFocusedKey(f,O),e.isLink(f)&&E==="override")return;a.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(f):u&&!se(a)&&e.replaceSelection(f)}};switch(a.key){case"ArrowDown":if(t.getKeyBelow){var C,F,r;let f=e.focusedKey!=null?(C=t.getKeyBelow)===null||C===void 0?void 0:C.call(t,e.focusedKey):(F=t.getFirstKey)===null||F===void 0?void 0:F.call(t);f==null&&s&&(f=(r=t.getFirstKey)===null||r===void 0?void 0:r.call(t,e.focusedKey)),f!=null&&(a.preventDefault(),$(f))}break;case"ArrowUp":if(t.getKeyAbove){var k,B,j;let f=e.focusedKey!=null?(k=t.getKeyAbove)===null||k===void 0?void 0:k.call(t,e.focusedKey):(B=t.getLastKey)===null||B===void 0?void 0:B.call(t);f==null&&s&&(f=(j=t.getLastKey)===null||j===void 0?void 0:j.call(t,e.focusedKey)),f!=null&&(a.preventDefault(),$(f))}break;case"ArrowLeft":if(t.getKeyLeftOf){var Y,Z,J;let f=e.focusedKey!=null?(Y=t.getKeyLeftOf)===null||Y===void 0?void 0:Y.call(t,e.focusedKey):null;f==null&&s&&(f=T==="rtl"?(Z=t.getFirstKey)===null||Z===void 0?void 0:Z.call(t,e.focusedKey):(J=t.getLastKey)===null||J===void 0?void 0:J.call(t,e.focusedKey)),f!=null&&(a.preventDefault(),$(f,T==="rtl"?"first":"last"))}break;case"ArrowRight":if(t.getKeyRightOf){var Q,X,_;let f=e.focusedKey!=null?(Q=t.getKeyRightOf)===null||Q===void 0?void 0:Q.call(t,e.focusedKey):null;f==null&&s&&(f=T==="rtl"?(X=t.getLastKey)===null||X===void 0?void 0:X.call(t,e.focusedKey):(_=t.getFirstKey)===null||_===void 0?void 0:_.call(t,e.focusedKey)),f!=null&&(a.preventDefault(),$(f,T==="rtl"?"last":"first"))}break;case"Home":if(t.getFirstKey){if(e.focusedKey===null&&a.shiftKey)return;a.preventDefault();let f=t.getFirstKey(e.focusedKey,U(a));e.setFocusedKey(f),f!=null&&(U(a)&&a.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(f):u&&e.replaceSelection(f))}break;case"End":if(t.getLastKey){if(e.focusedKey===null&&a.shiftKey)return;a.preventDefault();let f=t.getLastKey(e.focusedKey,U(a));e.setFocusedKey(f),f!=null&&(U(a)&&a.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(f):u&&e.replaceSelection(f))}break;case"PageDown":if(t.getKeyPageBelow&&e.focusedKey!=null){let f=t.getKeyPageBelow(e.focusedKey);f!=null&&(a.preventDefault(),$(f))}break;case"PageUp":if(t.getKeyPageAbove&&e.focusedKey!=null){let f=t.getKeyPageAbove(e.focusedKey);f!=null&&(a.preventDefault(),$(f))}break;case"a":U(a)&&e.selectionMode==="multiple"&&c!==!0&&(a.preventDefault(),e.selectAll());break;case"Escape":!o&&e.selectedKeys.size!==0&&(a.stopPropagation(),a.preventDefault(),e.clearSelection());break;case"Tab":if(!g){if(a.shiftKey)l.current.focus();else{let f=Le(l.current,{tabbable:!0}),O,V;do V=f.lastChild(),V&&(O=V);while(V);O&&!O.contains(document.activeElement)&&he(O)}break}}},w=d.useRef({top:0,left:0});H(h,"scroll",y?void 0:()=>{var a,p,$,C;w.current={top:($=(a=h.current)===null||a===void 0?void 0:a.scrollTop)!==null&&$!==void 0?$:0,left:(C=(p=h.current)===null||p===void 0?void 0:p.scrollLeft)!==null&&C!==void 0?C:0}});let b=a=>{if(e.isFocused){a.currentTarget.contains(a.target)||e.setFocused(!1);return}if(a.currentTarget.contains(a.target)){if(e.setFocused(!0),e.focusedKey==null){var p,$;let r=B=>{B!=null&&(e.setFocusedKey(B),u&&e.replaceSelection(B))},k=a.relatedTarget;var C,F;k&&a.currentTarget.compareDocumentPosition(k)&Node.DOCUMENT_POSITION_FOLLOWING?r((C=e.lastSelectedKey)!==null&&C!==void 0?C:(p=t.getLastKey)===null||p===void 0?void 0:p.call(t)):r((F=e.firstSelectedKey)!==null&&F!==void 0?F:($=t.getFirstKey)===null||$===void 0?void 0:$.call(t))}else!y&&h.current&&(h.current.scrollTop=w.current.top,h.current.scrollLeft=w.current.left);if(e.focusedKey!=null&&h.current){let r=h.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);r&&(r.contains(document.activeElement)||he(r),fe()==="keyboard"&&ye(r,{containingElement:l.current}))}}},D=a=>{a.currentTarget.contains(a.relatedTarget)||e.setFocused(!1)},M=d.useRef(!1);H(l,We,x?a=>{let{detail:p}=a;a.stopPropagation(),e.setFocused(!0),(p==null?void 0:p.focusStrategy)==="first"&&(M.current=!0)}:void 0);let z=de(()=>{var a,p;let $=(p=(a=t.getFirstKey)===null||a===void 0?void 0:a.call(t))!==null&&p!==void 0?p:null;if($==null){var C;(C=l.current)===null||C===void 0||C.dispatchEvent(new CustomEvent(De,{cancelable:!0,bubbles:!0})),e.collection.size>0&&(M.current=!1)}else e.setFocusedKey($),M.current=!1});pe(()=>{M.current&&z()},[e.collection,z]);let I=de(()=>{e.collection.size>0&&(M.current=!1)});pe(()=>{I()},[e.focusedKey,I]),H(l,qe,x?a=>{a.stopPropagation(),e.setFocused(!1),e.setFocusedKey(null)}:void 0);const P=d.useRef(i);d.useEffect(()=>{if(P.current){var a,p;let F=null;var $;i==="first"&&(F=($=(a=t.getFirstKey)===null||a===void 0?void 0:a.call(t))!==null&&$!==void 0?$:null);var C;i==="last"&&(F=(C=(p=t.getLastKey)===null||p===void 0?void 0:p.call(t))!==null&&C!==void 0?C:null);let r=e.selectedKeys;if(r.size){for(let k of r)if(e.canSelectItem(k)){F=k;break}}e.setFocused(!0),e.setFocusedKey(F),F==null&&!x&&l.current&&ie(l.current)}},[]);let N=d.useRef(e.focusedKey);d.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==N.current||P.current)&&h.current&&l.current){let a=fe(),p=l.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);if(!p)return;(a==="keyboard"||P.current)&&(ze(h.current,p),a!=="virtual"&&ye(p,{containingElement:l.current}))}!x&&e.isFocused&&e.focusedKey==null&&N.current!=null&&l.current&&ie(l.current),N.current=e.focusedKey,P.current=!1}),H(l,"react-aria-focus-scope-restore",a=>{a.preventDefault(),e.setFocused(!0)});let L={onKeyDown:v,onFocus:b,onBlur:D,onMouseDown(a){h.current===a.target&&a.preventDefault()}},{typeSelectProps:R}=lt({keyboardDelegate:t,selectionManager:e});m||(L=oe(R,L));let q;return x?q=-1:q=e.focusedKey==null?0:-1,{collectionProps:{...L,tabIndex:q}}}function Et(n){let{id:e,selectionManager:t,key:l,ref:i,shouldSelectOnPressUp:s,shouldUseVirtualFocus:o,focus:c,isDisabled:u,onAction:m,allowsDifferentPressOrigin:x,linkBehavior:g="action"}=n,y=ke();e=Te(e);let h=r=>{if(r.pointerType==="keyboard"&&se(r))t.toggleSelection(l);else{if(t.selectionMode==="none")return;if(t.isLink(l)){if(g==="selection"&&i.current){let k=t.getItemProps(l);y.open(i.current,r,k.href,k.routerOptions),t.setSelectedKeys(t.selectedKeys);return}else if(g==="override"||g==="none")return}t.selectionMode==="single"?t.isSelected(l)&&!t.disallowEmptySelection?t.toggleSelection(l):t.replaceSelection(l):r&&r.shiftKey?t.extendSelection(l):t.selectionBehavior==="toggle"||r&&(U(r)||r.pointerType==="touch"||r.pointerType==="virtual")?t.toggleSelection(l):t.replaceSelection(l)}};d.useEffect(()=>{if(l===t.focusedKey&&t.isFocused)if(!o)c?c():document.activeElement!==i.current&&i.current&&ie(i.current);else{var k;let B=new CustomEvent(De,{cancelable:!0,bubbles:!0});(k=i.current)===null||k===void 0||k.dispatchEvent(B)}},[i,l,t.focusedKey,t.childFocusStrategy,t.isFocused,o]),u=u||t.isDisabled(l);let E={};!o&&!u?E={tabIndex:l===t.focusedKey?0:-1,onFocus(r){r.target===i.current&&t.setFocusedKey(l)}}:u&&(E.onMouseDown=r=>{r.preventDefault()});let T=t.isLink(l)&&g==="override",S=t.isLink(l)&&g!=="selection"&&g!=="none",v=!u&&t.canSelectItem(l)&&!T,w=(m||S)&&!u,b=w&&(t.selectionBehavior==="replace"?!v:!v||t.isEmpty),D=w&&v&&t.selectionBehavior==="replace",M=b||D,z=d.useRef(null),I=M&&v,P=d.useRef(!1),N=d.useRef(!1),L=r=>{if(m&&m(),S&&i.current){let k=t.getItemProps(l);y.open(i.current,r,k.href,k.routerOptions)}},R={};s?(R.onPressStart=r=>{z.current=r.pointerType,P.current=I,r.pointerType==="keyboard"&&(!M||be())&&h(r)},x?(R.onPressUp=b?void 0:r=>{r.pointerType==="mouse"&&v&&h(r)},R.onPress=b?L:r=>{r.pointerType!=="keyboard"&&r.pointerType!=="mouse"&&v&&h(r)}):R.onPress=r=>{if(b||D&&r.pointerType!=="mouse"){if(r.pointerType==="keyboard"&&!me())return;L(r)}else r.pointerType!=="keyboard"&&v&&h(r)}):(R.onPressStart=r=>{z.current=r.pointerType,P.current=I,N.current=b,v&&(r.pointerType==="mouse"&&!b||r.pointerType==="keyboard"&&(!w||be()))&&h(r)},R.onPress=r=>{(r.pointerType==="touch"||r.pointerType==="pen"||r.pointerType==="virtual"||r.pointerType==="keyboard"&&M&&me()||r.pointerType==="mouse"&&N.current)&&(M?L(r):v&&h(r))}),E["data-key"]=l,R.preventFocusOnPress=o;let{pressProps:q,isPressed:a}=we(R),p=D?r=>{z.current==="mouse"&&(r.stopPropagation(),r.preventDefault(),L(r))}:void 0,{longPressProps:$}=et({isDisabled:!I,onLongPress(r){r.pointerType==="touch"&&(h(r),t.setSelectionBehavior("toggle"))}}),C=r=>{z.current==="touch"&&P.current&&r.preventDefault()},F=t.isLink(l)?r=>{Re.isOpening||r.preventDefault()}:void 0;return{itemProps:oe(E,v||b?q:{},I?$:{},{onDoubleClick:p,onDragStartCapture:C,onClick:F,id:e}),isPressed:a,isSelected:t.isSelected(l),isFocused:t.isFocused&&t.focusedKey===l,isDisabled:u,allowsSelection:v,hasAction:M}}function me(){let n=window.event;return(n==null?void 0:n.key)==="Enter"}function be(){let n=window.event;return(n==null?void 0:n.key)===" "||(n==null?void 0:n.code)==="Space"}class nt{build(e,t){return this.context=t,ge(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:l}=e;if(K.isValidElement(t)&&t.type===K.Fragment)yield*this.iterateCollection({children:t.props.children,items:l});else if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");let i=0;for(let s of l)yield*this.getFullNode({value:s,index:i},{renderer:t}),i++}else{let i=[];K.Children.forEach(t,o=>{o&&i.push(o)});let s=0;for(let o of i){let c=this.getFullNode({element:o,index:s},{});for(let u of c)s++,yield u}}}getKey(e,t,l,i){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${i}${t.key}`;let s=t.value;if(s!=null){var o;let c=(o=s.key)!==null&&o!==void 0?o:s.id;if(c==null)throw new Error("No key found for item");return c}return i?`${i}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,l,i){if(K.isValidElement(e.element)&&e.element.type===K.Fragment){let S=[];K.Children.forEach(e.element.props.children,w=>{S.push(w)});var s;let v=(s=e.index)!==null&&s!==void 0?s:0;for(const w of S)yield*this.getFullNode({element:w,index:v++},t,l,i);return}let o=e.element;if(!o&&e.value&&t&&t.renderer){let S=this.cache.get(e.value);if(S&&(!S.shouldInvalidate||!S.shouldInvalidate(this.context))){S.index=e.index,S.parentKey=i?i.key:null,yield S;return}o=t.renderer(e.value)}if(K.isValidElement(o)){let S=o.type;if(typeof S!="function"&&typeof S.getCollectionNode!="function"){let D=o.type;throw new Error(`Unknown element <${D}> in collection.`)}let v=S.getCollectionNode(o.props,this.context);var c;let w=(c=e.index)!==null&&c!==void 0?c:0,b=v.next();for(;!b.done&&b.value;){let D=b.value;e.index=w;var u;let M=(u=D.key)!==null&&u!==void 0?u:null;M==null&&(M=D.element?null:this.getKey(o,e,t,l));let I=[...this.getFullNode({...D,key:M,index:w,wrapper:st(e.wrapper,D.wrapper)},this.getChildState(t,D),l?`${l}${o.key}`:o.key,i)];for(let P of I){var m,x;P.value=(x=(m=D.value)!==null&&m!==void 0?m:e.value)!==null&&x!==void 0?x:null,P.value&&this.cache.set(P.value,P);var g;if(e.type&&P.type!==e.type)throw new Error(`Unsupported type <${ee(P.type)}> in <${ee((g=i==null?void 0:i.type)!==null&&g!==void 0?g:"unknown parent type")}>. Only <${ee(e.type)}> is supported.`);w++,yield P}b=v.next(I)}return}if(e.key==null||e.type==null)return;let y=this;var h,E;let T={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:(h=e.value)!==null&&h!==void 0?h:null,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:(E=e.textValue)!==null&&E!==void 0?E:"","aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:ge(function*(){if(!e.hasChildNodes||!e.childNodes)return;let S=0;for(let v of e.childNodes()){v.key!=null&&(v.key=`${T.key}${v.key}`);let w=y.getFullNode({...v,index:S},y.getChildState(t,v),T.key,T);for(let b of w)S++,yield b}})};yield T}constructor(){this.cache=new WeakMap}}function ge(n){let e=[],t=null;return{*[Symbol.iterator](){for(let l of e)yield l;t||(t=n());for(let l of t)e.push(l),yield l}}}function st(n,e){if(n&&e)return t=>n(e(t));if(n)return n;if(e)return e}function ee(n){return n[0].toUpperCase()+n.slice(1)}function Mt(n,e,t){let l=d.useMemo(()=>new nt,[]),{children:i,items:s,collection:o}=n;return d.useMemo(()=>{if(o)return o;let u=l.build({children:i,items:s},t);return e(u)},[l,i,s,o,t,e])}function ot(n,e){return typeof e.getChildren=="function"?e.getChildren(n.key):n.childNodes}function rt(n){return ut(n)}function ut(n,e){for(let t of n)return t}function te(n,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let l=[...Se(n,e),e],i=[...Se(n,t),t],s=l.slice(0,i.length).findIndex((o,c)=>o!==i[c]);return s!==-1?(e=l[s],t=i[s],e.index-t.index):l.findIndex(o=>o===t)>=0?1:(i.findIndex(o=>o===e)>=0,-1)}function Se(n,e){let t=[],l=e;for(;(l==null?void 0:l.parentKey)!=null;)l=n.getItem(l.parentKey),l&&t.unshift(l);return t}class A extends Set{constructor(e,t,l){super(e),e instanceof A?(this.anchorKey=t??e.anchorKey,this.currentKey=l??e.currentKey):(this.anchorKey=t??null,this.currentKey=l??null)}}function at(n,e){if(n.size!==e.size)return!1;for(let t of n)if(!e.has(t))return!1;return!0}function Ft(n){let{selectionMode:e="none",disallowEmptySelection:t=!1,allowDuplicateSelectionEvents:l,selectionBehavior:i="toggle",disabledBehavior:s="all"}=n,o=d.useRef(!1),[,c]=d.useState(!1),u=d.useRef(null),m=d.useRef(null),[,x]=d.useState(null),g=d.useMemo(()=>Ke(n.selectedKeys),[n.selectedKeys]),y=d.useMemo(()=>Ke(n.defaultSelectedKeys,new A),[n.defaultSelectedKeys]),[h,E]=Ue(g,y,n.onSelectionChange),T=d.useMemo(()=>n.disabledKeys?new Set(n.disabledKeys):new Set,[n.disabledKeys]),[S,v]=d.useState(i);i==="replace"&&S==="toggle"&&typeof h=="object"&&h.size===0&&v("replace");let w=d.useRef(i);return d.useEffect(()=>{i!==w.current&&(v(i),w.current=i)},[i]),{selectionMode:e,disallowEmptySelection:t,selectionBehavior:S,setSelectionBehavior:v,get isFocused(){return o.current},setFocused(b){o.current=b,c(b)},get focusedKey(){return u.current},get childFocusStrategy(){return m.current},setFocusedKey(b,D="first"){u.current=b,m.current=D,x(b)},selectedKeys:h,setSelectedKeys(b){(l||!at(b,h))&&E(b)},disabledKeys:T,disabledBehavior:s}}function Ke(n,e){return n?n==="all"?"all":new A(n):e}class Tt{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode==="none")return!1;let t=this.getKey(e);return t==null?!1:this.state.selectedKeys==="all"?this.canSelectItem(t):this.state.selectedKeys.has(t)}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let l of this.state.selectedKeys){let i=this.collection.getItem(l);(!e||i&&te(this.collection,i,e)<0)&&(e=i)}var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}get lastSelectedKey(){let e=null;for(let l of this.state.selectedKeys){let i=this.collection.getItem(l);(!e||i&&te(this.collection,i,e)>0)&&(e=i)}var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let l;if(this.state.selectedKeys==="all")l=new A([t],t,t);else{let o=this.state.selectedKeys;var i;let c=(i=o.anchorKey)!==null&&i!==void 0?i:t;l=new A(o,c,t);var s;for(let u of this.getKeyRange(c,(s=o.currentKey)!==null&&s!==void 0?s:t))l.delete(u);for(let u of this.getKeyRange(t,c))this.canSelectItem(u)&&l.add(u)}this.state.setSelectedKeys(l)}getKeyRange(e,t){let l=this.collection.getItem(e),i=this.collection.getItem(t);return l&&i?te(this.collection,l,i)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){var l;if(!((l=this.layoutDelegate)===null||l===void 0)&&l.getKeyRange)return this.layoutDelegate.getKeyRange(e,t);let i=[],s=e;for(;s!=null;){let o=this.collection.getItem(s);if(o&&(o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&i.push(s),s===t)return i;s=this.collection.getKeyAfter(s)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type==="cell"&&this.allowsCellSelection)return e;for(;t&&t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let l=new A(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);l.has(t)?l.delete(t):this.canSelectItem(t)&&(l.add(t),l.anchorKey=t,l.currentKey=t),!(this.disallowEmptySelection&&l.size===0)&&this.state.setSelectedKeys(l)}replaceSelection(e){if(this.selectionMode==="none")return;let t=this.getKey(e);if(t==null)return;let l=this.canSelectItem(t)?new A([t],t,t):new A;this.state.setSelectedKeys(l)}setSelectedKeys(e){if(this.selectionMode==="none")return;let t=new A;for(let l of e){let i=this.getKey(l);if(i!=null&&(t.add(i),this.selectionMode==="single"))break}this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=l=>{for(;l!=null;){if(this.canSelectItem(l)){var i;let o=this.collection.getItem(l);(o==null?void 0:o.type)==="item"&&e.push(l);var s;o!=null&&o.hasChildNodes&&(this.allowsCellSelection||o.type!=="item")&&t((s=(i=rt(ot(o,this.collection)))===null||i===void 0?void 0:i.key)!==null&&s!==void 0?s:null)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new A)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let l of e)if(!t.has(l))return!1;for(let l of t)if(!e.has(l))return!1;return!0}canSelectItem(e){var t;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let l=this.collection.getItem(e);return!(!l||!(l==null||(t=l.props)===null||t===void 0)&&t.isDisabled||l.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var t,l;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.isDisabled))}isLink(e){var t,l;return!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}getItemProps(e){var t;return(t=this.collection.getItem(e))===null||t===void 0?void 0:t.props}constructor(e,t,l){this.collection=e,this.state=t;var i;this.allowsCellSelection=(i=l==null?void 0:l.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null,this.layoutDelegate=(l==null?void 0:l.layoutDelegate)||null}}const At=d.createContext(null),ct={CollectionRoot({collection:n,renderDropIndicator:e}){return $e(n,null,e)},CollectionBranch({collection:n,parent:e,renderDropIndicator:t}){return $e(n,e,t)}};function $e(n,e,t){return Ee({items:e?n.getChildren(e.key):n,dependencies:[t],children(l){var i;let s=l.render(l);if(!t||l.type!=="item")return s;let o=l.key,c=n.getKeyAfter(o);return K.createElement(K.Fragment,null,t({type:"item",key:o,dropPosition:"before"}),s,(c==null||((i=n.getItem(c))===null||i===void 0?void 0:i.type)!=="item")&&t({type:"item",key:o,dropPosition:"after"}))}})}const It=d.createContext(ct);function Rt(n){return d.useMemo(()=>n!=null?new Set([n]):null,[n])}export{Dt as $,Et as a,Pt as b,Ft as c,Mt as d,Tt as e,wt as f,It as g,Rt as h,kt as i,ct as j,ot as k,At as l};
