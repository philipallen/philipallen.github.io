import{a as h}from"./Button-DPtumZN7.js";import{l as p,m as F,k as M,c as $,b as A,j as g,n as V,g as W,d as k}from"./utils-BPOuYIA2.js";import{$ as x}from"./filterDOMProps-CeZl_uWj.js";import{r as l,e as c}from"./index-CcKhGcwW.js";import{$ as P}from"./useControlledState-Bw1hdnkP.js";import{r as I}from"./index-uaANFLeC.js";import{$ as N}from"./useEvent-CR-cdJGO.js";import{a as D}from"./useFocusRing-G-z0GAlQ.js";function B(s,e,d){let{isDisabled:a}=s,n=p(),t=p(),o=!F()&&"onbeforematch"in document.body,i=l.useRef(null),u=l.useCallback(()=>{i.current=requestAnimationFrame(()=>{d.current&&d.current.setAttribute("hidden","until-found")}),I.flushSync(()=>{e.toggle()})},[d,e]);return N(d,"beforematch",o?u:null),M(()=>{i.current&&cancelAnimationFrame(i.current),o&&d.current&&!a&&(e.isExpanded?d.current.removeAttribute("hidden"):d.current.setAttribute("hidden","until-found"))},[a,d,e.isExpanded,o]),l.useEffect(()=>()=>{i.current&&cancelAnimationFrame(i.current)},[]),{buttonProps:{id:n,"aria-expanded":e.isExpanded,"aria-controls":t,onPress:f=>{!a&&f.pointerType!=="keyboard"&&e.toggle()},isDisabled:a,onPressStart(f){f.pointerType==="keyboard"&&!a&&e.toggle()}},panelProps:{id:t,role:"group","aria-labelledby":n,"aria-hidden":!e.isExpanded,hidden:o?!0:!e.isExpanded}}}function G(s){let[e,d]=P(s.isExpanded,s.defaultExpanded||!1,s.onExpandedChange);const a=l.useCallback(()=>{d(!0)},[d]),n=l.useCallback(()=>{d(!1)},[d]),t=l.useCallback(()=>{d(!e)},[d,e]);return{isExpanded:e,setExpanded:d,expand:a,collapse:n,toggle:t}}function T(s){let{allowsMultipleExpanded:e=!1,isDisabled:d=!1}=s,[a,n]=P(l.useMemo(()=>s.expandedKeys?new Set(s.expandedKeys):void 0,[s.expandedKeys]),l.useMemo(()=>s.defaultExpandedKeys?new Set(s.defaultExpandedKeys):new Set,[s.defaultExpandedKeys]),s.onExpandedChange);return l.useEffect(()=>{if(!e&&a.size>1){let t=a.values().next().value;t!=null&&n(new Set([t]))}}),{allowsMultipleExpanded:e,isDisabled:d,expandedKeys:a,setExpandedKeys:n,toggleKey(t){let r;e?(r=new Set(a),r.has(t)?r.delete(t):r.add(t)):r=new Set(a.has(t)?[]:[t]),n(r)}}}const v=l.createContext(null),X=l.forwardRef(function(e,d){let a=T(e),n=$({...e,defaultClassName:"react-aria-DisclosureGroup",values:{isDisabled:a.isDisabled,state:a}}),t=x(e);return c.createElement("div",{...t,...n,ref:d,"data-disabled":e.isDisabled||void 0},c.createElement(v.Provider,{value:a},n.children))}),_=l.createContext(null),j=l.createContext(null),C=l.createContext(null),Y=l.forwardRef(function(e,d){[e,d]=A(e,d,_);let a=l.useContext(v),{id:n,...t}=e,r=p();n||(n=r);let o=a?a.expandedKeys.has(n):e.isExpanded,i=G({...e,isExpanded:o,onExpandedChange(R){var b;a&&a.toggleKey(n),(b=e.onExpandedChange)===null||b===void 0||b.call(e,R)}}),u=c.useRef(null),f=e.isDisabled||(a==null?void 0:a.isDisabled)||!1,{buttonProps:y,panelProps:w}=B({...e,isExpanded:o,isDisabled:f},i,u),{isFocusVisible:m,focusProps:K}=D({within:!0}),E=$({...e,id:void 0,defaultClassName:"react-aria-Disclosure",values:{isExpanded:i.isExpanded,isDisabled:f,isFocusVisibleWithin:m,state:i}}),S=x(t);return c.createElement(g,{values:[[h,{slots:{[V]:{},trigger:y}}],[C,{panelProps:w,panelRef:u}],[j,i]]},c.createElement("div",{ref:d,"data-expanded":i.isExpanded||void 0,"data-disabled":f||void 0,"data-focus-visible-within":m||void 0,...S,...K,...E},E.children))}),Z=l.forwardRef(function(e,d){let{role:a="group"}=e,{panelProps:n,panelRef:t}=l.useContext(C),{isFocusVisible:r,focusProps:o}=D({within:!0}),i=$({...e,defaultClassName:"react-aria-DisclosurePanel",values:{isFocusVisibleWithin:r}}),u=x(e);return c.createElement("div",{...u,ref:W(d,t),...k(n,o),...i,role:a,"data-focus-visible-within":r||void 0},c.createElement(g,{values:[[h,null]]},e.children))});export{Y as $,Z as a,X as b};
